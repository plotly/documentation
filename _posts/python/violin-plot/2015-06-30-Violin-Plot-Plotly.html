---
permalink: python/violin-plot/
description: How to make Violun Charts in Python with Plotly.
title: Python Violin Plots | plotly
has_thumbnail: true
thumbnail: thumbnail/violin-plot.jpg
layout: user-guide
name: Violin Plots
language: python
display_as: statistical
has_thumbnail: true
page_type: example_index
order: 5
---
{% raw %}
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Violin-Plot-with-Python-Plotly">Violin Plot with Python Plotly<a class="anchor-link" href="#Violin-Plot-with-Python-Plotly">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Violin plot is a trace that  visually encodes the distribution of a data set, along with its  summary statistics.
It displays the graph of the estimated probability density function (pdf) mirrored about y-axis, and inside the violin-like shaped region,  the elements of a box plot (median, lower and upper quartile,   whisker position).</p>
<p>In this Jupyter Notebook we define the functions to get the  Plotly plot of a  violin plot. We  add the option to overlay onto the same axis the rug plot of the data set, in order to get more insights into its distributional properties.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="s">&#39;&lt;iframe src=https://plot.ly/~empet/13680/violin-rug-plot/ width=400 height=500&gt;&lt;/iframe&gt;&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[1]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe src=https://plot.ly/~empet/13680/violin-rug-plot/ width=400 height=500></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compute the summary statistics of data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">calc_stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span> <span class="nb">float</span><span class="p">)</span>    
    <span class="n">vals_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">vals_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">q2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;linear&#39;</span><span class="p">)</span>  
    <span class="n">q1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;lower&#39;</span><span class="p">)</span>
    <span class="n">q3</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;higher&#39;</span><span class="p">)</span>
    <span class="n">IQR</span><span class="o">=</span><span class="n">q3</span><span class="o">-</span><span class="n">q1</span>
    <span class="n">whisker_dist</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">IQR</span>
    <span class="c">#in order to prevent drawing whiskers outside the interval </span>
    <span class="c">#of data  one defines the whisker positions as:</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">q1</span> <span class="o">-</span> <span class="n">whisker_dist</span><span class="p">)])</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">q3</span> <span class="o">+</span> <span class="n">whisker_dist</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">vals_min</span><span class="p">,</span> <span class="n">vals_max</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="p">,</span><span class="n">q3</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span><span class="n">d2</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="kn">as</span> <span class="nn">py</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">plotly.tools</span> <span class="kn">as</span> <span class="nn">tls</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Functions that define violin components:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">make_half_violin</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span>  <span class="n">y</span><span class="p">,</span>  <span class="n">fillcolor</span><span class="o">=</span><span class="s">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s">&#39;rgb(50,50,50)&#39;</span><span class="p">):</span> 
    <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;(pdf(y), y)=(&#39;</span><span class="o">+</span><span class="s">&#39;{:0.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;, &#39;</span><span class="o">+</span><span class="s">&#39;{:0.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s">&#39;)&#39;</span>
          <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span> 
    <span class="k">return</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> 
                   <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">,</span>
                   <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                   <span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">,</span>
                   <span class="n">fill</span><span class="o">=</span><span class="s">&#39;tozerox&#39;</span><span class="p">,</span>
                   <span class="n">fillcolor</span><span class="o">=</span> <span class="n">fillcolor</span><span class="p">,</span>
                   <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">linecolor</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="s">&#39;spline&#39;</span><span class="p">),</span>
                   <span class="n">hoverinfo</span><span class="o">=</span><span class="s">&#39;text&#39;</span><span class="p">,</span>
                   <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span>
                   <span class="p">)</span>
             

<span class="k">def</span> <span class="nf">make_rugplot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">pdf_max</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;#1f77b4&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">vals</span><span class="p">,</span> 
                   <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">pdf_max</span><span class="o">-</span><span class="n">distance</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span>
                   <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span>
                             <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                             <span class="n">symbol</span><span class="o">=</span><span class="s">&#39;line-ew-open&#39;</span>
                             <span class="p">),</span>
                   <span class="n">mode</span><span class="o">=</span><span class="s">&#39;markers&#39;</span><span class="p">,</span>
                   <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                   <span class="n">showlegend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                   <span class="n">hoverinfo</span><span class="o">=</span><span class="s">&#39;y&#39;</span>
                <span class="p">)</span>  
<span class="k">def</span> <span class="nf">make_quartiles</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q3</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q3</span><span class="p">],</span>
                   <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;lower-quartile: &#39;</span><span class="o">+</span><span class="s">&#39;{:0.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q1</span><span class="p">),</span> 
                         <span class="s">&#39;upper-quartile: &#39;</span><span class="o">+</span><span class="s">&#39;{:0.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q3</span><span class="p">)],</span>
                   <span class="n">mode</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">,</span>
                   <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;rgb(0,0,0)&#39;</span><span class="p">),</span>
                   <span class="n">hoverinfo</span><span class="o">=</span><span class="s">&#39;text&#39;</span>
                  <span class="p">)</span>
<span class="k">def</span> <span class="nf">make_median</span><span class="p">(</span><span class="n">q2</span><span class="p">):</span>
    <span class="k">return</span>   <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                     <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">q2</span><span class="p">],</span> 
                     <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;median: &#39;</span><span class="o">+</span><span class="s">&#39;{:0.2f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">q2</span><span class="p">)],</span>
                     <span class="n">mode</span><span class="o">=</span><span class="s">&#39;markers&#39;</span><span class="p">,</span>
                     <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="s">&#39;square&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;rgb(255,255,255)&#39;</span><span class="p">),</span>
                     <span class="n">hoverinfo</span><span class="o">=</span><span class="s">&#39;text&#39;</span>
                            <span class="p">)</span>
<span class="k">def</span> <span class="nf">make_non_outlier_interval</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span><span class="n">d2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
                   <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span>
                   <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                   <span class="n">mode</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">,</span>
                   <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;rgb(0,0,0)&#39;</span><span class="p">)</span>
                   <span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set  axes:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre> 
<span class="k">def</span> <span class="nf">make_XAxis</span><span class="p">(</span><span class="n">xaxis_title</span><span class="p">,</span> <span class="n">xaxis_range</span><span class="p">):</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">xaxis_title</span><span class="p">,</span>
                <span class="nb">range</span><span class="o">=</span><span class="n">xaxis_range</span><span class="p">,</span>
                <span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">zeroline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">showline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">mirror</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">ticks</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                <span class="n">showticklabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
               <span class="p">)</span>
    <span class="k">return</span> <span class="n">xaxis</span>


<span class="k">def</span> <span class="nf">make_YAxis</span><span class="p">(</span><span class="n">yaxis_title</span><span class="p">):</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="n">YAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">yaxis_title</span><span class="p">,</span>
                  <span class="n">showticklabels</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">autorange</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">ticklen</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                  <span class="n">showline</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                  <span class="n">zeroline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                  <span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                  <span class="n">mirror</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>                   
    <span class="k">return</span> <span class="n">yaxis</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Data values, <code>vals</code>, can be given in a numeric list, numpy array of shape (n, ) or a pandas series.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because a violin plot is symmetric with respect to a vertical axis, we define the range of x values
in the plot either
of the form <code>range=[-a,a]</code> or of the form <code>[-b,a]</code>, when a rug plot is overlaid.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">create_violinplot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span>  <span class="n">fillcolor</span><span class="o">=</span><span class="s">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="n">rugplot</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">vals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">vals_min</span><span class="p">,</span> <span class="n">vals_max</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q3</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="o">=</span><span class="n">calc_stats</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="c">#summary statistics</span>
    
    <span class="n">pdf</span><span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">gaussian_kde</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="c"># kernel density estimation of pdf</span>
    <span class="n">xx</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vals_min</span><span class="p">,</span> <span class="n">vals_max</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="c"># grid over the data interval</span>
    <span class="n">yy</span><span class="o">=</span><span class="n">pdf</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="c">#evaluate the pdf at the grid xx</span>
    <span class="n">max_pdf</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span>
    <span class="n">distance</span><span class="o">=</span><span class="mf">2.0</span><span class="o">*</span><span class="n">max_pdf</span><span class="o">/</span><span class="mi">10</span> <span class="k">if</span> <span class="n">rugplot</span> <span class="k">else</span> <span class="mi">0</span><span class="c"># distance from the violin plot to rugplot</span>
    <span class="n">plot_xrange</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">max_pdf</span><span class="o">-</span><span class="n">distance</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_pdf</span><span class="o">+</span><span class="mf">0.1</span><span class="p">]</span><span class="c"># range for x values in the plot</span>
    
    <span class="n">plot_data</span><span class="o">=</span><span class="p">[</span><span class="n">make_half_violin</span><span class="p">(</span><span class="o">-</span><span class="n">yy</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="n">fillcolor</span><span class="p">),</span>
               <span class="n">make_half_violin</span><span class="p">(</span><span class="n">yy</span><span class="p">,</span> <span class="n">xx</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="n">fillcolor</span><span class="p">),</span>
               <span class="n">make_non_outlier_interval</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">),</span>
               <span class="n">make_quartiles</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q3</span><span class="p">),</span>
               <span class="n">make_median</span><span class="p">(</span><span class="n">q2</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">rugplot</span><span class="p">:</span> 
        <span class="n">plot_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">make_rugplot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">max_pdf</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">fillcolor</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">plot_data</span><span class="p">,</span> <span class="n">plot_xrange</span>    
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us define first a single violin plot:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">&#39;Violin-plot-data.xlsx&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.55</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.13</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.38</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6.35</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">x</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;Score&#39;</span><span class="p">])</span>
<span class="n">plot_data</span><span class="p">,</span> <span class="n">plot_xrange</span><span class="o">=</span><span class="n">create_violinplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="s">&#39;rgb(102,194,163)&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Violin  and  Rug Plot&#39;</span><span class="p">,</span>
    <span class="n">autosize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">font</span><span class="o">=</span><span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">),</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="n">make_XAxis</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">plot_xrange</span><span class="p">),</span>     
    <span class="n">yaxis</span><span class="o">=</span><span class="n">make_YAxis</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span>
    <span class="n">hovermode</span><span class="o">=</span><span class="s">&#39;closest&#39;</span>
    <span class="p">)</span>          
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">layout</span><span class="p">[</span><span class="s">&#39;yaxis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">showline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">showticklabels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">fig</span><span class="o">=</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="n">plot_data</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">sign_in</span><span class="p">(</span><span class="s">&#39;empet&#39;</span><span class="p">,</span> <span class="s">&#39;my_api_key&#39;</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;Violin-Plot-Example&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[14]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~tarzzz/2014.embed" height="450px" width="350px"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Data summary encoded in a violin plot facilitate comparison of multiple data sets. 
In the following  we generate  a few data sets and  their violin plots:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">619517</span><span class="p">)</span>
<span class="n">Nr</span><span class="o">=</span><span class="mi">250</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>
<span class="n">gr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="s">&quot;ABCDE&quot;</span><span class="p">),</span> <span class="n">Nr</span><span class="p">)</span>
<span class="n">norm_params</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)]</span><span class="c"># mean and standard deviations </span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">letter</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s">&quot;ABCDE&quot;</span><span class="p">):</span>
    <span class="n">y</span><span class="p">[</span><span class="n">gr</span> <span class="o">==</span> <span class="n">letter</span><span class="p">]</span> <span class="o">*=</span><span class="n">norm_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span> <span class="n">norm_params</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">Score</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">Group</span><span class="o">=</span><span class="n">gr</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B</td>
      <td>1.656178</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C</td>
      <td>-1.379259</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>1.567691</td>
    </tr>
    <tr>
      <th>3</th>
      <td>B</td>
      <td>1.484571</td>
    </tr>
    <tr>
      <th>4</th>
      <td>E</td>
      <td>0.410634</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Group data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">gb</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;Group&#39;</span><span class="p">])</span>
<span class="n">group_name</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;A&#39;</span><span class="p">,</span> <span class="s">&#39;B&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;D&#39;</span><span class="p">,</span> <span class="s">&#39;E&#39;</span><span class="p">]</span>
<span class="n">L</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">group_name</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each violin plot will be displayed in a subplot:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">tls</span><span class="o">.</span><span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">L</span><span class="p">,</span>  <span class="n">shared_yaxes</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> 
                           <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span>                      
                           <span class="n">print_grid</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>This is the format of your plot grid:
[ (1,1) x1,y1 ]  [ (1,2) x2,y1 ]  [ (1,3) x3,y1 ]  [ (1,4) x4,y1 ]  [ (1,5) x5,y1 ]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Set colors for violins:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">violet_colors</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;#604d9e&#39;</span><span class="p">,</span><span class="s">&#39;#6c4774&#39;</span><span class="p">,</span><span class="s">&#39;#9e70a2&#39;</span><span class="p">,</span><span class="s">&#39;#caaac2&#39;</span><span class="p">,</span><span class="s">&#39;#d6c7dd&#39;</span><span class="p">]</span><span class="c">#violet palette</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get  plot data  for each group, and assign them to the corresponding subplot:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">gr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">group_name</span><span class="p">):</span>
    <span class="n">vals</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span> <span class="n">gb</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">gr</span><span class="p">)[</span><span class="s">&#39;Score&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
    <span class="n">plot_data</span><span class="p">,</span> <span class="n">plot_xrange</span><span class="o">=</span><span class="n">create_violinplot</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">fillcolor</span><span class="o">=</span><span class="n">violet_colors</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">plot_data</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">append_trace</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">[</span><span class="s">&#39;layout&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;xaxis{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> 
                          <span class="n">make_XAxis</span><span class="p">(</span><span class="s">&#39;Group &#39;</span><span class="o">+</span><span class="s">&#39;{:d}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">plot_xrange</span><span class="p">)})</span>    
<span class="n">fig</span><span class="p">[</span><span class="s">&#39;layout&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;yaxis{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span> <span class="n">make_YAxis</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)})</span><span class="c"># set the sharey axis style    </span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">pl_width</span><span class="o">=</span><span class="mi">900</span>
<span class="n">pl_height</span><span class="o">=</span><span class="mi">500</span>
<span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Violin Plots&#39;</span>

<span class="n">fig</span><span class="p">[</span><span class="s">&#39;layout&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>                                 
                        <span class="n">font</span><span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s">&#39;Georgia, serif&#39;</span><span class="p">),</span>
                        <span class="n">showlegend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>     
                        <span class="n">hovermode</span><span class="o">=</span><span class="s">&#39;closest&#39;</span><span class="p">,</span>  
                        <span class="n">autosize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>       
                        <span class="n">width</span><span class="o">=</span><span class="n">pl_width</span><span class="p">,</span>       
                        <span class="n">height</span><span class="o">=</span><span class="n">pl_height</span><span class="p">,</span>
                        <span class="n">margin</span><span class="o">=</span><span class="n">Margin</span><span class="p">(</span>
                                      <span class="n">l</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span>
                                      <span class="n">r</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span>
                                      <span class="n">b</span><span class="o">=</span><span class="mi">85</span><span class="p">,</span>
                                      <span class="n">t</span><span class="o">=</span><span class="mi">150</span>
                                     <span class="p">)</span>
                       <span class="p">)</span>    
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">sign_in</span><span class="p">(</span><span class="s">&#39;empet&#39;</span><span class="p">,</span> <span class="s">&#39;my_api_key&#39;</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;Multiple-Violins&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[23]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~tarzzz/2016.embed" height="500px" width="900px"></iframe>
</div>

</div>

</div>
</div>

</div>{% endraw %}
