---
permalink: python/isosurfaces-with-marching-cubes/
description: How to make Iso Surface in Python with Plotly.
name: Iso Surface | plotly
has_thumbnail: true
thumbnail: thumbnail/isosurface.jpg
layout: user-guide
name: Iso Surface
language: python
title: Python Iso Surface | plotly
display_as: 3d_charts
has_thumbnail: true
order: 12
ipynb: ~notebook_demo/72
---
{% raw %}
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="New-to-Plotly?">New to Plotly?<a class="anchor-link" href="#New-to-Plotly?">&#182;</a></h4><p>Plotly's Python library is free and open source! <a href="https://plot.ly/python/getting-started/">Get started</a> by downloading the client and <a href="https://plot.ly/python/getting-started/">reading the primer</a>.
<br>You can set up Plotly to work in <a href="https://plot.ly/python/getting-started/#initialization-for-online-plotting">online</a> or <a href="https://plot.ly/python/getting-started/#initialization-for-offline-plotting">offline</a> mode, or in <a href="https://plot.ly/python/getting-started/#start-plotting-online">jupyter notebooks</a>.
<br>We also have a quick-reference <a href="https://images.plot.ly/plotly-documentation/images/python_cheat_sheet.pdf">cheatsheet</a> (new!) to help you get started!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Plotly-Isosurfaces-Defined-as-Trisurfs">Plotly Isosurfaces Defined as Trisurfs<a class="anchor-link" href="#Plotly-Isosurfaces-Defined-as-Trisurfs">&#182;</a></h4><p>A surface, <code>F(x,y,z) = c</code> is discretized by a triangular mesh, extracted  by the  <a href="http://scikit-image.org/docs/dev/auto_examples/edges/plot_marching_cubes.html">Marching cubes algorithm</a> from  a volume given as a 
(M, N, P) array of doubles.
<br>The scikit image function, <code>measure.marching_cubes(F, c)</code> returns the vertices and simplices of the triangulated surface.</p>
<p>First, define a grid within the parallelepiped [-2,2] x [-2,2] x [-2,2], and give the function F, defining a surface
of equation F(x,y,z) = 0:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="kn">as</span> <span class="nn">py</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">plotly.tools</span> <span class="kn">import</span> <span class="n">FigureFactory</span> <span class="k">as</span> <span class="n">FF</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">measure</span>

<span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">40j</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">40j</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">40j</span><span class="p">]</span>
<span class="n">surf_eq</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">Y</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">Z</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Y</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">Z</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span>   
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Triangulate-the-Given-Surface:">Triangulate the Given Surface:<a class="anchor-link" href="#Triangulate-the-Given-Surface:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">vertices</span><span class="p">,</span> <span class="n">simplices</span> <span class="o">=</span> <span class="n">measure</span><span class="o">.</span><span class="n">marching_cubes</span><span class="p">(</span><span class="n">surf_eq</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">vertices</span><span class="p">)</span>  
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Color-According-to-a-colormap-and-Plot:">Color According to a colormap and Plot:<a class="anchor-link" href="#Color-According-to-a-colormap-and-Plot:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">colormap</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rgb(255,105,180)&#39;</span><span class="p">,</span><span class="s1">&#39;rgb(255,255,51)&#39;</span><span class="p">,</span><span class="s1">&#39;rgb(0,191,255)&#39;</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">FF</span><span class="o">.</span><span class="n">create_trisurf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
                        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> 
                        <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> 
                        <span class="n">plot_edges</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                        <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                        <span class="n">simplices</span><span class="o">=</span><span class="n">simplices</span><span class="p">,</span>
                        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Isosurface&quot;</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[3]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;" seamless="seamless" src="https://plot.ly/~AdamKulidjian/958.embed" height="800px" width="800px"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Reference">Reference<a class="anchor-link" href="#Reference">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">FF</span><span class="o">.</span><span class="n">create_trisurf</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function create_trisurf in module plotly.tools:

create_trisurf(x, y, z, simplices, colormap=None, show_colorbar=True, color_func=None, title=&#39;Trisurf Plot&#39;, plot_edges=True, showbackground=True, backgroundcolor=&#39;rgb(230, 230, 230)&#39;, gridcolor=&#39;rgb(255, 255, 255)&#39;, zerolinecolor=&#39;rgb(255, 255, 255)&#39;, edges_color=&#39;rgb(50, 50, 50)&#39;, height=800, width=800, aspectratio={&#39;x&#39;: 1, &#39;y&#39;: 1, &#39;z&#39;: 1})
    Returns figure for a triangulated surface plot
    
    :param (array) x: data values of x in a 1D array
    :param (array) y: data values of y in a 1D array
    :param (array) z: data values of z in a 1D array
    :param (array) simplices: an array of shape (ntri, 3) where ntri is
        the number of triangles in the triangularization. Each row of the
        array contains the indicies of the verticies of each triangle
    :param (str|tuple|list) colormap: either a plotly scale name, an rgb
        or hex color, a color tuple or a list of colors. An rgb color is
        of the form &#39;rgb(x, y, z)&#39; where x, y, z belong to the interval
        [0, 255] and a color tuple is a tuple of the form (a, b, c) where
        a, b and c belong to [0, 1]. If colormap is a list, it must
        contain the valid color types aforementioned as its members
    :param (bool) show_colorbar: determines if colorbar is visible
    :param (function|list) color_func: The parameter that determines the
        coloring of the surface. Takes either a function with 3 arguments
        x, y, z or a list/array of color values the same length as
        simplices. If None, coloring will only depend on the z axis
    :param (str) title: title of the plot
    :param (bool) plot_edges: determines if the triangles on the trisurf
        are visible
    :param (bool) showbackground: makes background in plot visible
    :param (str) backgroundcolor: color of background. Takes a string of
        the form &#39;rgb(x,y,z)&#39; x,y,z are between 0 and 255 inclusive
    :param (str) gridcolor: color of the gridlines besides the axes. Takes
        a string of the form &#39;rgb(x,y,z)&#39; x,y,z are between 0 and 255
        inclusive
    :param (str) zerolinecolor: color of the axes. Takes a string of the
        form &#39;rgb(x,y,z)&#39; x,y,z are between 0 and 255 inclusive
    :param (str) edges_color: color of the edges, if plot_edges is True
    :param (int|float) height: the height of the plot (in pixels)
    :param (int|float) width: the width of the plot (in pixels)
    :param (dict) aspectratio: a dictionary of the aspect ratio values for
        the x, y and z axes. &#39;x&#39;, &#39;y&#39; and &#39;z&#39; take (int|float) values
    
    Example 1: Sphere
    ```
    # Necessary Imports for Trisurf
    import numpy as np
    from scipy.spatial import Delaunay
    
    import plotly.plotly as py
    from plotly.tools import FigureFactory as FF
    from plotly.graph_objs import graph_objs
    
    # Make data for plot
    u = np.linspace(0, 2*np.pi, 20)
    v = np.linspace(0, np.pi, 20)
    u,v = np.meshgrid(u,v)
    u = u.flatten()
    v = v.flatten()
    
    x = np.sin(v)*np.cos(u)
    y = np.sin(v)*np.sin(u)
    z = np.cos(v)
    
    points2D = np.vstack([u,v]).T
    tri = Delaunay(points2D)
    simplices = tri.simplices
    
    # Create a figure
    fig1 = FF.create_trisurf(x=x, y=y, z=z,
                             colormap=&#34;Blues&#34;,
                             simplices=simplices)
    # Plot the data
    py.iplot(fig1, filename=&#39;trisurf-plot-sphere&#39;)
    ```
    
    Example 2: Torus
    ```
    # Necessary Imports for Trisurf
    import numpy as np
    from scipy.spatial import Delaunay
    
    import plotly.plotly as py
    from plotly.tools import FigureFactory as FF
    from plotly.graph_objs import graph_objs
    
    # Make data for plot
    u = np.linspace(0, 2*np.pi, 20)
    v = np.linspace(0, 2*np.pi, 20)
    u,v = np.meshgrid(u,v)
    u = u.flatten()
    v = v.flatten()
    
    x = (3 + (np.cos(v)))*np.cos(u)
    y = (3 + (np.cos(v)))*np.sin(u)
    z = np.sin(v)
    
    points2D = np.vstack([u,v]).T
    tri = Delaunay(points2D)
    simplices = tri.simplices
    
    # Create a figure
    fig1 = FF.create_trisurf(x=x, y=y, z=z,
                             colormap=&#34;Greys&#34;,
                             simplices=simplices)
    # Plot the data
    py.iplot(fig1, filename=&#39;trisurf-plot-torus&#39;)
    ```
    
    Example 3: Mobius Band
    ```
    # Necessary Imports for Trisurf
    import numpy as np
    from scipy.spatial import Delaunay
    
    import plotly.plotly as py
    from plotly.tools import FigureFactory as FF
    from plotly.graph_objs import graph_objs
    
    # Make data for plot
    u = np.linspace(0, 2*np.pi, 24)
    v = np.linspace(-1, 1, 8)
    u,v = np.meshgrid(u,v)
    u = u.flatten()
    v = v.flatten()
    
    tp = 1 + 0.5*v*np.cos(u/2.)
    x = tp*np.cos(u)
    y = tp*np.sin(u)
    z = 0.5*v*np.sin(u/2.)
    
    points2D = np.vstack([u,v]).T
    tri = Delaunay(points2D)
    simplices = tri.simplices
    
    # Create a figure
    fig1 = FF.create_trisurf(x=x, y=y, z=z,
                             colormap=[(0.2, 0.4, 0.6), (1, 1, 1)],
                             simplices=simplices)
    # Plot the data
    py.iplot(fig1, filename=&#39;trisurf-plot-mobius-band&#39;)
    ```
    
    Example 4: Using a Custom Colormap Function with Light Cone
    ```
    # Necessary Imports for Trisurf
    import numpy as np
    from scipy.spatial import Delaunay
    
    import plotly.plotly as py
    from plotly.tools import FigureFactory as FF
    from plotly.graph_objs import graph_objs
    
    # Make data for plot
    u=np.linspace(-np.pi, np.pi, 30)
    v=np.linspace(-np.pi, np.pi, 30)
    u,v=np.meshgrid(u,v)
    u=u.flatten()
    v=v.flatten()
    
    x = u
    y = u*np.cos(v)
    z = u*np.sin(v)
    
    points2D = np.vstack([u,v]).T
    tri = Delaunay(points2D)
    simplices = tri.simplices
    
    # Define distance function
    def dist_origin(x, y, z):
        return np.sqrt((1.0 * x)**2 + (1.0 * y)**2 + (1.0 * z)**2)
    
    # Create a figure
    fig1 = FF.create_trisurf(x=x, y=y, z=z,
                             colormap=[&#39;#604d9e&#39;,
                                       &#39;rgb(50, 150, 255)&#39;,
                                       (0.2, 0.2, 0.8)],
                             simplices=simplices,
                             color_func=dist_origin)
    # Plot the data
    py.iplot(fig1, filename=&#39;trisurf-plot-custom-coloring&#39;)
    ```
    
    Example 5: Enter color_func as a list of colors
    ```
    # Necessary Imports for Trisurf
    import numpy as np
    from scipy.spatial import Delaunay
    import random
    
    import plotly.plotly as py
    from plotly.tools import FigureFactory as FF
    from plotly.graph_objs import graph_objs
    
    # Make data for plot
    u=np.linspace(-np.pi, np.pi, 30)
    v=np.linspace(-np.pi, np.pi, 30)
    u,v=np.meshgrid(u,v)
    u=u.flatten()
    v=v.flatten()
    
    x = u
    y = u*np.cos(v)
    z = u*np.sin(v)
    
    points2D = np.vstack([u,v]).T
    tri = Delaunay(points2D)
    simplices = tri.simplices
    
    
    colors = []
    color_choices = [&#39;rgb(0, 0, 0)&#39;, &#39;#6c4774&#39;, &#39;#d6c7dd&#39;]
    
    for index in range(len(simplices)):
        colors.append(random.choice(color_choices))
    
    fig = FF.create_trisurf(
        x, y, z, simplices,
        color_func=colors,
        show_colorbar=True,
        edges_color=&#39;rgb(2, 85, 180)&#39;,
        title=&#39; Modern Art&#39;
    )
    
    py.iplot(fig, filename=&#34;trisurf-plot-modern-art&#34;)
    ```

</pre>
</div>
</div>

</div>
</div>

</div>{% endraw %}