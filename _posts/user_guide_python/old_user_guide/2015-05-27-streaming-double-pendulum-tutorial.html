---
permalink: python/streaming-double-pendulum-tutorial/
description: A tutorial on how to make a beautiful streaming plot of a never-ending double pendulum simulation with plotly and Python or IPython.
name: Streaming plots
layout: user-guide
thumbnail: /images/static-image.png
language: python
page_type: u-guide
has_thumbnail: false
---


   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h2 id="Section-7:-Plotly's-Streaming-API-part-2">
       Section 7: Plotly's Streaming API part 2
       <a class="anchor-link" href="#Section-7:-Plotly's-Streaming-API-part-2">
        ¶
       </a>
      </h2>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Welcome to Plotly's Python API User Guide.
      </p>
      <blockquote>
       <p>
        Links to the other sections are on the User Guide's
        <a href="/python/user-guide#Table-of-Contents:">
         homepage
        </a>
        <br/>
        The Github repository is available
        <a href="https://github.com/plotly/python-user-guide" target="_blank">
         here
        </a>
       </p>
      </blockquote>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Section 7 is divided, into separate notebooks, as follows:
      </p>
      <ul>
       <li>
        <p>
         <a href="/python/streaming-tutorial">
          7.0 Streaming API introduction
         </a>
        </p>
       </li>
       <li>
        <p>
         <a href="/python/streaming-line-tutorial">
          7.1 A first Plotly streaming plot
         </a>
        </p>
       </li>
       <li>
        <p>
         <a href="/python/streaming-double-pendulum-tutorial">
          7.2 Never-ending double pendulum simulation
         </a>
        </p>
       </li>
       <li>
        <p>
         <a href="/python/streaming-bubbles-tutorial">
          7.3 An animated version of Hans Rosling's bubble chart
         </a>
        </p>
       </li>
      </ul>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <hr/>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Check which version is installed on your machine and please upgrade if needed.
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[1]">
      <a class="prompt input_prompt" href="#in-[1]">
       In [1]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># (*) Import plotly package</span>
<span class="kn">import</span> <span class="nn">plotly</span>

<span class="c"># Check plolty version (if not latest, please upgrade)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">__version__</span>
</pre>
       </div>
      </div>
     </div>
    </div>
    <div class="output_wrapper">
     <div class="output">
      <div class="output_area">
       <div class="prompt output_prompt" id="out[1]">
        <a class="prompt output_prompt" href="#out[1]">
         Out[1]:
        </a>
       </div>
       <div class="output_text output_subarea output_pyout">
        <pre>
'1.6.6'
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       See the User Guide's
       <a href="/python/user-guide#Installation-guidelines" target="_blank">
        homepage
       </a>
       for more info on installation and upgrading.
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       We first import a few modules and sign in to Plotly using our credentials file:
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[2]">
      <a class="prompt input_prompt" href="#in-[2]">
       In [2]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># (*) To communicate with Plotly's server, sign in with credentials file</span>
<span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="kn">as</span> <span class="nn">py</span>

<span class="c"># (*) Useful Python/Plotly tools</span>
<span class="kn">import</span> <span class="nn">plotly.tools</span> <span class="kn">as</span> <span class="nn">tls</span>

<span class="c"># (*) Graph objects to piece together plots</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>  <span class="c"># (*) numpy for math functions and arrays</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       If you are not familiar with credentials files, refer to the User Guide's
       <a href="/python/user-guide#Step-6" target="_blank">
        homepage
       </a>
       .
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Finally, retrieve the stream ids in our credentials file as set up in
       <a href="/python/streaming-tutorial#Get-your-stream-tokens" target="_blank">
        subsection 7.1
       </a>
       :
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[3]">
      <a class="prompt input_prompt" href="#in-[3]">
       In [3]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="n">stream_ids</span> <span class="o">=</span> <span class="n">tls</span><span class="o">.</span><span class="n">get_credentials_file</span><span class="p">()[</span><span class="s">'stream_ids'</span><span class="p">]</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h3 id="7.2-Never-ending-double-pendulum-simulation">
       7.2 Never-ending double pendulum simulation
       <a class="anchor-link" href="#7.2-Never-ending-double-pendulum-simulation">
        ¶
       </a>
      </h3>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Now that we are warmed up, let's generate something a little more impressive.
      </p>
      <p>
       In our next plot, we simulation the motion of a double pendulum in real-time. If ever you are interested, this Wikipedia
       <a href="http://en.wikipedia.org/wiki/Double_pendulum" target="_blank">
        article
       </a>
       goes over the equations decribing the motion of a double pendulum in details. In essence, we are solving a system of non-linear ordinary differential equations (ODEs) of the form
      </p>
      <p>
       $$ \frac{\partial \boldsymbol{x}}{\partial t} = F(\boldsymbol{x}) \;,$$
      </p>
      <p>
       using the
       <code>
        scipy.integrate
       </code>
       module. In the above, $\boldsymbol{x}$ is the state vector composed of the angles and angular velocities of both pendulums, the left-hand side is its time derivative and the right-hand side is a system of non-linear functions of the state vector.
      </p>
      <p>
       The following code has been adapted from the
       <a href="http://matplotlib.org/examples/animation/double_pendulum_animated.html" target="_blank">
        Matplotlib example bank
       </a>
       . Big thanks!
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       We first define the ODEs and the initial conditions:
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[4]">
      <a class="prompt input_prompt" href="#in-[4]">
       In [4]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># (*) Import a few functions from numpy, for cleaner code</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>

<span class="c">## Define a few constants</span>
<span class="n">G</span> <span class="o">=</span>  <span class="mf">9.8</span>      <span class="c"># acceleration due to gravity, in m/s^2</span>
<span class="n">L1</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c"># length of pendulum 1 in m</span>
<span class="n">L2</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c"># length of pendulum 2 in m</span>
<span class="n">M1</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c"># mass of pendulum 1 in kg</span>
<span class="n">M2</span> <span class="o">=</span> <span class="mf">1.0</span>      <span class="c"># mass of pendulum 2 in kg</span>
<span class="n">rad</span> <span class="o">=</span> <span class="n">pi</span><span class="o">/</span><span class="mi">180</span>  <span class="c"># radians in 1 deg</span>

<span class="c">## Set the initial conditions</span>
<span class="n">th1</span> <span class="o">=</span> <span class="mf">120.0</span>  <span class="c"># th1 and th2 are the initial angles (degrees)</span>
<span class="n">th2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mf">0.0</span>     <span class="c"># w10 and w20 are the initial angular velocities (degrees per second)</span>
<span class="n">w2</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">th1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">th2</span><span class="p">,</span> <span class="n">w2</span><span class="p">])</span><span class="o">*</span><span class="n">rad</span>  <span class="c"># initial state array</span>

<span class="c">## Time derivatives of each state array variables </span>
<span class="k">def</span> <span class="nf">derivs</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">dxdt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>   <span class="c"># init. dervative array</span>
    <span class="n">del_</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>    <span class="c"># difference of angle1 and angle2</span>

    <span class="n">dxdt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>            <span class="c"># derv. of angle1</span>

    <span class="n">den1</span> <span class="o">=</span> <span class="p">(</span><span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="n">L1</span> <span class="o">-</span> <span class="n">M2</span><span class="o">*</span><span class="n">L1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>  <span class="c"># deno. of dxdt[2]</span>
    <span class="n">dxdt</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">M2</span><span class="o">*</span><span class="n">L1</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>
               <span class="o">+</span> <span class="n">M2</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>
               <span class="o">+</span> <span class="n">M2</span><span class="o">*</span><span class="n">L2</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>
               <span class="o">-</span> <span class="p">(</span><span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">/</span><span class="n">den1</span>     <span class="c"># derv. of angular velo.1</span>

    <span class="n">dxdt</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>  <span class="c"># derv. of angle2</span>

    <span class="n">den2</span> <span class="o">=</span> <span class="p">(</span><span class="n">L2</span><span class="o">/</span><span class="n">L1</span><span class="p">)</span><span class="o">*</span><span class="n">den1</span>  <span class="c"># deno. of dxdt[3]</span>
    <span class="n">dxdt</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">M2</span><span class="o">*</span><span class="n">L2</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>
               <span class="o">+</span> <span class="p">(</span><span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>
               <span class="o">-</span> <span class="p">(</span><span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="n">L1</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">state</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">del_</span><span class="p">)</span>
               <span class="o">-</span> <span class="p">(</span><span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="p">)</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">/</span><span class="n">den2</span>   <span class="c"># derv. of angular velo.2</span>

    <span class="k">return</span> <span class="n">dxdt</span>  <span class="c"># return time derv. array</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Our next plot features two traces:
      </p>
      <ul>
       <li>
        <p>
         The double pendulum itself consisting of three nodes (two free nodes and an attached one).
        </p>
       </li>
       <li>
        <p>
         The path of the double pendulum's bottom node previous to the current time.
        </p>
       </li>
      </ul>
      <p>
       Therefore, we need
       <strong>
        two unique streams!
       </strong>
      </p>
      <p>
       So, let's initialize our Plotly streaming plot along with some style options for both traces:
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[5]">
      <a class="prompt input_prompt" href="#in-[5]">
       In [5]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># Init. 1st scatter obj (the pendulums) with stream_ids[1]</span>
<span class="n">trace1</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[],</span>  <span class="c"># init. data lists</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s">'lines+markers'</span><span class="p">,</span>    <span class="c"># markers at pendulum's nodes, lines in-bt.</span>
    <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">),</span>  <span class="c"># reduce opacity</span>
    <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>  <span class="c"># increase marker size</span>
    <span class="n">stream</span><span class="o">=</span><span class="n">Stream</span><span class="p">(</span><span class="n">token</span><span class="o">=</span><span class="n">stream_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c"># (!) link stream id to token</span>
<span class="p">)</span>

<span class="c"># (!) No need to set 'maxpoints' in trace1 as we will stream lists (more below)</span>

<span class="c"># Init. 2nd scatter obj (path pendulum's bottom node) with stream_ids[2]</span>
<span class="n">trace2</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[],</span>  <span class="c"># init. data lists</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s">'lines'</span><span class="p">,</span>                             <span class="c"># path drawn as line</span>
    <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">'rgba(31,119,180,0.15)'</span><span class="p">),</span> <span class="c"># light blue line color</span>
    <span class="n">stream</span><span class="o">=</span><span class="n">Stream</span><span class="p">(</span>
        <span class="n">token</span><span class="o">=</span><span class="n">stream_ids</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>  <span class="c"># (!) link streamid to token</span>
        <span class="n">maxpoints</span><span class="o">=</span><span class="mi">100</span>         <span class="c"># plot a max of 100 pts on screen</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c"># Make data object made up of the 2 scatter objs</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">([</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">])</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[6]">
      <a class="prompt input_prompt" href="#in-[6]">
       In [6]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># Define dictionary of axis style options</span>
<span class="n">axis_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>    <span class="c"># remove grid</span>
    <span class="n">showline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>    <span class="c"># remove axes lines</span>
    <span class="n">zeroline</span><span class="o">=</span><span class="bp">False</span>     <span class="c"># remove x=0 and y=0 lines</span>
<span class="p">)</span>

<span class="c"># Make layout with title and set axis ranges</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s">'Double Pendulum Simulation'</span><span class="p">,</span>  <span class="c"># set plot's title</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span>
        <span class="n">axis_style</span><span class="p">,</span>     <span class="c"># add style options</span>
        <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>    <span class="c"># set x-axis range</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span>
        <span class="n">axis_style</span><span class="p">,</span>     <span class="c"># add style options</span>
        <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>  <span class="c"># set y-axis range</span>
    <span class="p">),</span>
    <span class="n">showlegend</span><span class="o">=</span><span class="bp">False</span>    <span class="c"># remove legend</span>
<span class="p">)</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[7]">
      <a class="prompt input_prompt" href="#in-[7]">
       In [7]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># Make figure object</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

<span class="c"># (@) Send fig to Plotly, initialize streaming plot, open tab</span>
<span class="n">unique_url</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">'s7_streaming-double-pendulum'</span><span class="p">)</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Here's a screenshot of our plot pre-streaming (with our old UI):
      </p>
      <p>
       <img src="{{site.staticurl}}/images/py-user-guide-img/image15.png"/>
      </p>
      <p>
       <br/>
      </p>
      <p>
       Next, we make two stream link objects and open their connections:
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[8]">
      <a class="prompt input_prompt" href="#in-[8]">
       In [8]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># (@) Make 1st instance of the stream link object, </span>
<span class="c">#     with same stream id as the 1st stream id object (in trace1)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">stream_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c"># (@) Make 2nd instance of the stream link object, </span>
<span class="c">#     with same stream id as the 2nd stream id object (in trace2)</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">py</span><span class="o">.</span><span class="n">Stream</span><span class="p">(</span><span class="n">stream_ids</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c"># (@) Open both streams</span>
<span class="n">s1</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">s2</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Finally, we send data into our two streams,
       <code>
        s1
       </code>
       and
       <code>
        s2
       </code>
       .
      </p>
      <p>
       In this case, we integrate the equations with a time step of 0.05 seconds and update the double's pendulum position and path every 80 milliseconds, for smoother plotting.
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[9]">
      <a class="prompt input_prompt" href="#in-[9]">
       In [9]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># (*) Import module to integrate ODE and keep track of time</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span> <span class="kn">as</span> <span class="nn">integrate</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>   <span class="c"># number of time integrate.odeint() integrations </span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>   <span class="c"># init. counter</span>

<span class="c"># Delay start of stream by 5 sec (time to switch tabs)</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="c"># (-) Solve the system of ODEs N times</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>

    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>                      <span class="c"># add to counter</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>                   <span class="c"># create a time array from 0..100  </span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>  <span class="c"># sampled at 0.05 second steps (of 400 steps in all)</span>

    <span class="c"># Solve the system of ODEs, for times in t!</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">odeint</span><span class="p">(</span><span class="n">derivs</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>

    <span class="n">x1</span> <span class="o">=</span> <span class="n">L1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>        <span class="c"># convert angles to x-y coordinates</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="o">-</span><span class="n">L1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">L2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">x1</span>   <span class="c">#   for both pendulums</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="o">-</span><span class="n">L2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">y1</span>

    <span class="c"># (!) Write the solutions to Plotly's servers, </span>
    <span class="c">#     1 per stream, 1 point at a time</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">x1i</span><span class="p">,</span> <span class="n">y1i</span><span class="p">,</span> <span class="n">x2i</span><span class="p">,</span> <span class="n">y2i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">):</span>

        <span class="c"># (@) Write list corresponding to 3 pendulum nodes,</span>
        <span class="c">#     overwriting the data on the plot</span>
        <span class="n">s1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">x1i</span><span class="p">,</span> <span class="n">x2i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y1i</span><span class="p">,</span> <span class="n">y2i</span><span class="p">]))</span>

        <span class="c"># (@) Write 1 point corresponding to 1 pt of path,</span>
        <span class="c">#     appending the data on the plot</span>
        <span class="n">s2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x2i</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y2i</span><span class="p">))</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.08</span><span class="p">)</span>  <span class="c"># (!) plot pts 80 ms at a time, for smoother plotting</span>

    <span class="c"># Set the new initial state</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>

<span class="c"># (@) Close both streams when done plotting</span>
<span class="n">s1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">s2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Please note that we write a list into
       <code>
        s1
       </code>
       at every update time. This overwrites the existing list (in this case the double pendulum's previous position). In contrast, we send numbers (one x-coordinate and one y-coordinate) into
       <code>
        s2
       </code>
       which appends the existing list.
      </p>
      <p>
       Again, if you have the computer resources, why not have
      </p>
      <pre><code>&gt;&gt;&gt; while True:
</code></pre>
      <p>
       as while-loop expression and have a never-ending double pendulum simulation.
      </p>
      <p>
       The Plotly team did it. Enjoy:
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt" id="in-[10]">
      <a class="prompt input_prompt" href="#in-[10]">
       In [10]:
      </a>
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><span class="c"># Embed never-ending simulation</span>
<span class="n">tls</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="s">'streaming-demos'</span><span class="p">,</span> <span class="s">'4'</span><span class="p">)</span>
</pre>
       </div>
      </div>
     </div>
    </div>
    <div class="output_wrapper">
     <div class="output">
      <div class="output_area">
       <div class="prompt output_prompt" id="out[10]">
        <a class="prompt output_prompt" href="#out[10]">
         Out[10]:
        </a>
       </div>
       <div class="output_html rendered_html output_subarea output_pyout">
        <iframe height="525" id="igraph" scrolling="no" seamless="seamless" src="https://plot.ly/~streaming-demos/4.embed" style="border:none;" width="100%">
        </iframe>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Pretty cool, right?
      </p>
      <p>
       Watch the end points of the trailing path dissapear as, in this example, the maximum number of on-screen points is set to 100 (with the
       <code>
        'maxpoints'
       </code>
       key in the stream id object).
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Subsections of section 7:
      </p>
      <ul>
       <li>
        <p>
         <a href="/python/streaming-tutorial">
          7.0 Streaming API introduction
         </a>
        </p>
       </li>
       <li>
        <p>
         <a href="/python/streaming-line-tutorial">
          7.1 A first Plotly streaming plot
         </a>
        </p>
       </li>
       <li>
        <p>
         <a href="/python/streaming-double-pendulum-tutorial">
          7.2 Never-ending double pendulum simulation
         </a>
        </p>
       </li>
       <li>
        <p>
         <a href="/python/streaming-bubbles-tutorial">
          7.3 An animated version of Hans Rosling's bubble chart
         </a>
        </p>
       </li>
      </ul>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <hr/>
      <h4 style="font-size:14pt;">
       Go to
       <a href="/python/3d-plots-tutorial">
        Section 8  --- 3D Plots
       </a>
      </h4>
      <h4 style="font-size:14pt;">
       Go to
       <a href="/python/matplotlib-to-plotly-tutorial">
        Section 6  --- Convert your Matplotlib plots to Plotly
       </a>
      </h4>
      <h4 style="font-size:14pt;">
       Go to
       <a href="#notebook">
        top of page
       </a>
      </h4>
      <h4 style="font-size:14pt;">
       Go to User Guide's
       <a href="/python/user-guide">
        homepage
       </a>
      </h4>
      <hr/>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <div style="float:right; \">
       <img align="right" src="{{site.staticurl}}/images/py-user-guide-img/image06.png" style="float:right; margin-left: 5px; margin-top: -10px"/>
      </div>
      <h4>
       Got Questions or Feedback?
      </h4>
      <p>
       About
       <a href="https://plot.ly" target="_blank">
        Plotly
       </a>
      </p>
      <ul>
       <li>
        email: feedback@plot.ly
       </li>
       <li>
        tweet:
        <a href="https://twitter.com/plotlygraphs" target="_blank">
         @plotlygraphs
        </a>
       </li>
      </ul>
      <p>
       About the
       <a href="https://github.com/plotly/python-user-guide" target="_blank">
        User Guide
       </a>
      </p>
      <ul>
       <li>
        email: etienne@plot.ly
       </li>
       <li>
        tweet:
        <a href="https://twitter.com/etpinard" target="_blank">
         @etpinard
        </a>
       </li>
      </ul>
      <h4 style="margin-top:30px;">
       Notebook styling ideas
      </h4>
      <p>
       Big thanks to
      </p>
      <ul>
       <li>
        <a href="http://nbviewer.ipython.org/github/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Prologue/Prologue.ipynb" target="_blank">
         Cam Davidson-Pilon
        </a>
       </li>
       <li>
        <a href="http://lorenabarba.com/blog/announcing-aeropython/#.U1ULXdX1LJ4.google_plusone_share" target="_blank">
         Lorena A. Barba
        </a>
       </li>
      </ul>
      <p>
       <br/>
      </p>
     </div>
    </div>
   </div>
