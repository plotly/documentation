---
name: constraining slope with <code>stat_smooth</code>
plot_url: https://plot.ly/~MattSundquist/17259/
language: ggplot2
suite: geom_point
description: Inspired by <a href="http://stackoverflow.com/questions/4251294/constraining-slope-in-stat-smooth-with-ggplot-plotting-ancova">Stack Overflow</a>.
order: 5
sitemap: false
---
library(plotly)

set.seed(1234)

n <- 20

x1 <- rnorm(n); x2 <- rnorm(n)
y1 <- 2 * x1 + rnorm(n)
y2 <- 3 * x2 + (2 + rnorm(n))
A <- as.factor(rep(c(1, 2), each = n))
df <- data.frame(x = c(x1, x2), y = c(y1, y2), A = A)
fm <- lm(y ~ x + A, data = df)

p <- ggplot(data = cbind(df, pred = predict(fm)), aes(x = x, y = y, color = A))
p + geom_point() + geom_line(aes(y = pred))

ggplotly()
