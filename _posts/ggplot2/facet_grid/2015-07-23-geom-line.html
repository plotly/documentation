---
name: <code>facet_grid</code> time series with <code>geom_line</code>
plot_url: https://plot.ly/~MattSundquist/17931/
language: ggplot2
suite: grid
description: Inspired by <a href="http://stackoverflow.com/questions/11458349/add-text-to-a-faceted-plot-in-ggplot2-with-dates-on-x-axis?rq=1">Stack Overflow</a>.
order: 12
sitemap: false
---
library(plotly)
library(plyr)

date <- rep(as.Date(1:365,origin='2011-1-1'),7)
location <- factor(rep(1:7,365))
product <- rep(letters[1:7], each=365)
value <- c(sample(1:10, size=365, replace=T),sample(1:3, size=365, replace=T),
           sample(10:100, size=365, replace=T), sample(1:50, size=365, replace=T),
           sample(1:20, size=365, replace=T),sample(50:100, size=365, replace=T),
           sample(1:100, size=365, replace=T))
dat<-data.frame(date,location,product,value)


corr_dat<-ddply(dat, .(product), summarise, value=value)
corr.df<-unstack(corr_dat, value~product)

corr_plot <- data.frame(date=max(dat$date),
                        label=paste0("rho==",round(cor(corr.df)[,1], 2)),
                        ddply(dat, .(product), summarise,
                              value=(min(value)+max(value))/2))

ggplot(dat, aes(x=date, y=value, color=location, group=location)) +
    geom_line()+
    facet_grid(product ~ ., scale = "free_y")

ggplotly()
