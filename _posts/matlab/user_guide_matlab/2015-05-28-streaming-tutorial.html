---
permalink: matlab/streaming-tutorial/
description: How to graph data in real-time
name: Streaming plots
layout: base
thumbnail: /images/static-image.png
language: matlab
page_type: u-guide
---

 <div class="border-box-sizing" id="notebook" tabindex="-1">
  <div class="container" id="notebook-container">
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h3>
       <center>
        <strong>
          Streaming is no longer supported in Chart Studio Cloud. Streaming is still available as part of
          <a class="nounderlineblack" href="https://plot.ly/products/on-premise/">Chart Studio Enterprise.</a>
        </strong>
       </center>
      </h3>
     </div>
    </div>
   </div>


   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h3 id="-hr-size-5-br-getting-streaming-a-basic-example-">
       <hr size="5"/>
       Getting Started:
      </h3>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt">
      In [4]:
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><code class="matlab"><span class="o">%</span><span class="k">load_ext</span> <span class="n">pymatbridge</span>
</code></pre>
       </div>
      </div>
     </div>
    </div>
    <div class="output_wrapper">
     <div class="output">
      <div class="output_area">
       <div class="prompt">
       </div>
       <div class="output_subarea output_stream output_stdout output_text">
        <pre>Starting MATLAB<sup>&reg;</sup> on ZMQ socket ipc:///tmp/pymatbridge
Send 'exit' command to kill the server
.................MATLAB<sup>&reg;</sup> started and connected!

</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       <br/>
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h4 id="-font-size-5-1-font-setup-your-plotly-matlab-api-library-">
       <strong>
        <font size="5">
         [1]:
        </font>
       </strong>
       Setup your Plotly Graphing Library for MATLAB<sup>&reg;</sup>.
      </h4>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt">
      In [6]:
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><code class="matlab"><span class="o">%%</span><span class="k">matlab</span>
<span class="o">%</span><span class="k">plotlysetup</span><span class="p">(</span><span class="s">'username'</span><span class="p">,</span><span class="s">'api_key'</span><span class="p">,</span><span class="s">'stream_ids'</span><span class="p">,{</span><span class="s">'stream_token1'</span><span class="p">,</span><span class="o">...</span><span class="p">});</span>
</code></pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       Uncomment the above line and fill in your credentials. Your 'username', 'api_key' and 'stream_tokens' are initialized once you
       <a class="nounderline" href="https://plot.ly">
        MAKE A PLOTLY ACCOUNT
       </a>
       !
      </p>
      <p>
       <br/>
       <br/>
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h4 id="-font-size-5-2-font-create-a-plotly-plot-with-a-unique-stream-token-">
       <strong>
        <font size="5">
         [2]:
        </font>
       </strong>
       Create a Plotly plot with a unique stream token.
      </h4>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt">
      In [7]:
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><code class="matlab"><span class="o">%%</span><span class="k">matlab</span>
<span class="o">%----</span><span class="n">STORED</span> <span class="n">STREAMING</span> <span class="n">CREDENTIALS</span><span class="o">----%</span>
<span class="n">my_credentials</span> <span class="o">=</span> <span class="n">loadplotlycredentials</span><span class="p">;</span>
<span class="n">my_stream_token</span> <span class="o">=</span> <span class="n">my_credentials</span><span class="o">.</span><span class="n">stream_ids</span><span class="p">{</span><span class="n">end</span><span class="p">};</span>

<span class="o">%----</span><span class="n">SETUP</span><span class="o">-----%</span>

<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">'scatter'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_stream_token</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">maxpoints</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s">'MY_FIRST_STREAM'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">fileopt</span> <span class="o">=</span> <span class="s">'overwrite'</span><span class="p">;</span>

<span class="o">%----</span><span class="n">PLOTLY</span><span class="o">-----%</span>

<span class="n">resp</span> <span class="o">=</span> <span class="n">plotly</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">args</span><span class="p">);</span>
<span class="n">URL_OF_PLOT</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">url</span>
</code></pre>
       </div>
      </div>
     </div>
    </div>
    <div class="output_wrapper">
     <div class="output">
      <div class="output_area">
       <div class="prompt">
       </div>
       <div class="output_text output_subarea ">
        <pre>URL_OF_PLOT =

https://plot.ly/~matlab_user_guide/849


</pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       <br/>
       <br/>
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h4 id="-font-size-5-3-font-initialize-a-plotlystream-object-">
       <strong>
        <font size="5">
         [3]:
        </font>
       </strong>
       Initialize a plotlystream object.
      </h4>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt">
      In [8]:
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><code class="matlab"><span class="o">%%</span><span class="k">matlab</span>
<span class="n">ps</span> <span class="o">=</span> <span class="n">plotlystream</span><span class="p">(</span><span class="n">my_stream_token</span><span class="p">);</span>
</code></pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       <br/>
       <br/>
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h4 id="-font-size-5-4-font-stream-your-data-using-the-plotlystream-object-methods-">
       <strong>
        <font size="5">
         [4]:
        </font>
       </strong>
       Stream your data using the plotlystream object methods.
      </h4>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt">
      In [9]:
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><code class="matlab"><span class="o">%%</span><span class="k">matlab</span>
<span class="o">%----</span><span class="nb">open</span> <span class="n">the</span> <span class="n">stream</span><span class="o">----%</span>

<span class="n">ps</span><span class="o">.</span><span class="n">open</span><span class="p">();</span>

<span class="o">%----</span><span class="n">write</span> <span class="n">to</span> <span class="n">the</span> <span class="n">stream</span><span class="o">----%</span>

<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1000</span>
    <span class="n">mydata</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">mydata</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">rand</span><span class="p">;</span>
    <span class="n">ps</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mydata</span><span class="p">);</span>
    <span class="o">%</span><span class="k">take</span> <span class="n">a</span> <span class="n">breath</span>
    <span class="n">pause</span><span class="p">(</span><span class="mf">0.05</span><span class="p">);</span>
<span class="n">end</span>

<span class="o">%----</span><span class="n">close</span> <span class="n">the</span> <span class="n">stream</span><span class="o">----%</span>

<span class="n">ps</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>
</code></pre>
       </div>
      </div>
     </div>
    </div>
    <div class="output_wrapper">
     <div class="output">
      <div class="output_area">
       <div class="prompt">
       </div>
       <div class="output_text output_subarea ">
        <pre><code class="matlab">[Connection Successful]

</code></pre>
       </div>
      </div>
     </div>
    </div>
   </div>

   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <h3 id="-br-hr-size-5-br-streaming-signal-analysis-from-above-">
       <br/>
       <hr size="5"/>
       <br/>
       STREAMING SIGNAL ANALYSIS (FROM ABOVE):
      </h3>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
      <p>
       The following code is used to generate the Fourier analysis streaming plot from the above example. Feel free to copy the code and modify it in any way! Again, we would love to hear from you with links to the streams you create.
       <br/>
      </p>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing code_cell rendered">
    <div class="input">
     <div class="prompt input_prompt">
      In [10]:
     </div>
     <div class="inner_cell">
      <div class="input_area">
       <div class="highlight">
        <pre><code class="matlab"><span class="o">%%</span><span class="k">capture</span>
<span class="o">%%</span><span class="k">matlab</span>
<span class="o">%----</span><span class="n">plotly</span> <span class="n">setup</span><span class="o">----%</span>

<span class="o">%</span><span class="k">max</span> <span class="n">streaming</span> <span class="n">points</span>
<span class="n">maxpoints</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>

<span class="o">%</span><span class="k">credientials</span>
<span class="n">my_credentials</span> <span class="o">=</span> <span class="n">loadplotlycredentials</span><span class="p">;</span>

<span class="o">%</span><span class="k">signal1</span> <span class="p">(</span><span class="n">time</span> <span class="n">domain</span><span class="p">)</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">'scatter'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">'lines+markers'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="s">'spline'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'rgba(100,20,250,0.5)'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="s">'circle'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_credentials</span><span class="o">.</span><span class="n">stream_ids</span><span class="p">{</span><span class="n">end</span><span class="o">-</span><span class="mi">4</span><span class="p">};</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">maxpoints</span> <span class="o">=</span> <span class="n">maxpoints</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">autorange</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'$s_1$'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="s">'x1'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">yaxis</span> <span class="o">=</span> <span class="s">'y1'</span><span class="p">;</span>

<span class="o">%</span><span class="k">signal2</span> <span class="p">(</span><span class="n">time</span> <span class="n">domain</span><span class="p">)</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">'scatter'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">'lines+markers'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'rgba(0,200,200,0.5)'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="s">'spline'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="s">'circle'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_credentials</span><span class="o">.</span><span class="n">stream_ids</span><span class="p">{</span><span class="n">end</span><span class="o">-</span><span class="mi">3</span><span class="p">};</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">maxpoints</span> <span class="o">=</span> <span class="n">maxpoints</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'$s_2$'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="s">'x1'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">yaxis</span> <span class="o">=</span> <span class="s">'y1'</span><span class="p">;</span>

<span class="o">%</span><span class="k">signal1</span> <span class="p">(</span><span class="n">frequency</span> <span class="n">domain</span><span class="p">)</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">'scatter'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">'lines'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_credentials</span><span class="o">.</span><span class="n">stream_ids</span><span class="p">{</span><span class="n">end</span><span class="o">-</span><span class="mi">2</span><span class="p">};</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'rgba(0,0,0,1)'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'$|FFT(s_1)|$'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="s">'tozeroy'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">fillcolor</span> <span class="o">=</span>  <span class="s">'rgba(100,20,250,0.5)'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="s">'x2'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">yaxis</span> <span class="o">=</span> <span class="s">'y2'</span><span class="p">;</span>

<span class="o">%</span><span class="k">signal2</span> <span class="p">(</span><span class="n">frequency</span> <span class="n">domain</span><span class="p">)</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">'scatter'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">'lines'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="p">[];</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">my_credentials</span><span class="o">.</span><span class="n">stream_ids</span><span class="p">{</span><span class="n">end</span><span class="o">-</span><span class="mi">1</span><span class="p">};</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">'rgba(0,0,0,1)'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">fillcolor</span> <span class="o">=</span> <span class="s">'rgba(0,200,200,0.5)'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="s">'tozeroy'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'$|FFT(s_2)|$'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">xaxis</span> <span class="o">=</span> <span class="s">'x2'</span><span class="p">;</span>
<span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">yaxis</span> <span class="o">=</span> <span class="s">'y2'</span><span class="p">;</span>

<span class="o">%---</span><span class="n">layout</span> <span class="ow">and</span> <span class="n">plot</span> <span class="n">options</span><span class="o">---%</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">'REAL TIME SIGNAL ANALYSIS'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">'Time [s.]'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis1</span><span class="o">.</span><span class="n">showgrid</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis1</span><span class="o">.</span><span class="n">showline</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis1</span><span class="o">.</span><span class="n">mirror</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis1</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="s">'y1'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">'Amplitude'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="s">'x1'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">7</span> <span class="mi">7</span><span class="p">];</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">nticks</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">showline</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">mirror</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">zeroline</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">zerolinewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">showgrid</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis1</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.6</span> <span class="mi">1</span><span class="p">];</span>

<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">'Magnitude'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">'Frequency [Hz.]'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">showline</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">zeroline</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">mirror</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">nticks</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="s">'y2'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">xaxis2</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">showline</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">mirror</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">nticks</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">zeroline</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mf">0.4</span><span class="p">];</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="s">'x2'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">yaxis2</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">100</span><span class="p">];</span>

<span class="n">args</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="s">'stream_example_fourier'</span><span class="p">;</span>
<span class="n">args</span><span class="o">.</span><span class="n">fileopt</span> <span class="o">=</span> <span class="s">'overwrite'</span><span class="p">;</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">plotly</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">args</span><span class="p">);</span>
<span class="n">resp</span><span class="o">.</span><span class="n">url</span>


<span class="o">%----</span><span class="n">SIGNAL</span> <span class="n">GENERATION</span><span class="o">---%</span>

<span class="o">%</span><span class="k">Sampling</span> <span class="n">frequency</span>
<span class="n">SR</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

<span class="o">%</span><span class="k">N</span> <span class="p">(</span><span class="n">length</span> <span class="n">of</span> <span class="n">fft</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">128</span><span class="p">;</span>

<span class="o">%</span><span class="k">Duration</span>
<span class="n">dur</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="n">SR</span><span class="p">;</span>

<span class="o">%</span><span class="k">Amplitude</span> <span class="n">vector</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">];</span>

<span class="n">src1</span> <span class="o">=</span> <span class="p">[</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">' ,...</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',...</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',...</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',....</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">'];</span>

<span class="n">src2</span> <span class="o">=</span> <span class="p">[</span> <span class="n">A</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',...</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',...</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',....</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">',....</span>
           <span class="p">;</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="o">*</span><span class="n">dur</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">/</span><span class="n">SR</span><span class="p">)</span><span class="s">'];</span>

<span class="o">%</span><span class="k">frequency</span> <span class="n">vector</span>
<span class="n">freq</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">SR</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>

<span class="o">%</span><span class="k">length</span> <span class="n">of</span> <span class="n">stream</span>
<span class="n">los</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">src1</span><span class="p">);</span>

<span class="o">%</span><span class="k">create</span> <span class="n">plotlystream</span> <span class="n">objects</span>
<span class="n">sigstream_time1</span> <span class="o">=</span> <span class="n">plotlystream</span><span class="p">(</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span><span class="p">);</span>
<span class="n">sigstream_time2</span> <span class="o">=</span> <span class="n">plotlystream</span><span class="p">(</span><span class="n">data</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span><span class="p">);</span>
<span class="n">sigstream_freq1</span> <span class="o">=</span> <span class="n">plotlystream</span><span class="p">(</span><span class="n">data</span><span class="p">{</span><span class="mi">3</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span><span class="p">);</span>
<span class="n">sigstream_freq2</span> <span class="o">=</span> <span class="n">plotlystream</span><span class="p">(</span><span class="n">data</span><span class="p">{</span><span class="mi">4</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">token</span><span class="p">);</span>

<span class="o">%</span><span class="k">open</span> <span class="n">the</span> <span class="n">streams</span>
<span class="n">sigstream_time1</span><span class="o">.</span><span class="n">open</span><span class="p">;</span>
<span class="n">sigstream_time2</span><span class="o">.</span><span class="n">open</span><span class="p">;</span>
<span class="n">sigstream_freq1</span><span class="o">.</span><span class="n">open</span><span class="p">;</span>
<span class="n">sigstream_freq2</span><span class="o">.</span><span class="n">open</span><span class="p">;</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">maxpoints</span><span class="p">;</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">while</span> <span class="n">true</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">los</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>

    <span class="o">%</span><span class="k">stream</span> <span class="n">data</span> <span class="n">of</span> <span class="n">signal</span> <span class="mi">1</span> <span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">datast1t</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="n">SR</span><span class="p">;</span>
    <span class="n">datast1t</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">src1</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

    <span class="o">%</span><span class="k">stream</span> <span class="n">data</span> <span class="n">of</span> <span class="n">signal</span> <span class="mi">2</span> <span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">datast2t</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">i</span><span class="o">/</span><span class="n">SR</span><span class="p">;</span>
    <span class="n">datast2t</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">src2</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

    <span class="o">%</span><span class="k">stream</span> <span class="n">data</span> <span class="n">of</span> <span class="n">signal</span> <span class="mi">1</span> <span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="n">datast1f</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">freq</span><span class="p">;</span>
    <span class="n">F</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">src1</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">maxpoints</span><span class="p">:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">los</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">));</span>
    <span class="n">datast1f</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">freq</span><span class="p">));</span>

    <span class="o">%</span><span class="k">stream</span> <span class="n">data</span> <span class="n">of</span> <span class="n">signal</span> <span class="mi">2</span> <span class="p">(</span><span class="n">freq</span><span class="p">)</span>
    <span class="n">datast2f</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">freq</span><span class="p">;</span>
    <span class="n">F</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fft</span><span class="p">(</span><span class="n">src2</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">data</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">maxpoints</span><span class="p">:(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">los</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">N</span><span class="p">));</span>
    <span class="n">datast2f</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">freq</span><span class="p">));</span>

    <span class="o">%</span><span class="k">write</span> <span class="n">stream</span> <span class="n">data</span>
    <span class="n">sigstream_time1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datast1t</span><span class="p">);</span>
    <span class="n">sigstream_time2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datast2t</span><span class="p">);</span>
    <span class="n">sigstream_freq1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datast1f</span><span class="p">);</span>
    <span class="n">sigstream_freq2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">datast2f</span><span class="p">);</span>

    <span class="o">%</span><span class="k">take</span> <span class="n">a</span> <span class="n">breath</span>
       <span class="n">pause</span><span class="p">(</span><span class="mf">0.05</span><span class="p">);</span>

<span class="n">end</span>

<span class="o">%</span><span class="k">close</span> <span class="n">the</span> <span class="n">streams</span> <span class="n">before</span> <span class="n">they</span> <span class="n">cross</span><span class="err">!</span> <span class="p">(</span><span class="n">a</span> <span class="n">la</span> <span class="n">Ghostbusters</span><span class="p">)</span>

<span class="n">sigstream_time1</span><span class="o">.</span><span class="n">close</span><span class="p">;</span>
<span class="n">sigstream_time2</span><span class="o">.</span><span class="n">close</span><span class="p">;</span>
<span class="n">sigstream_freq1</span><span class="o">.</span><span class="n">close</span><span class="p">;</span>
<span class="n">sigstream_freq2</span><span class="o">.</span><span class="n">close</span><span class="p">;</span>
</code></pre>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="cell border-box-sizing text_cell rendered">
    <div class="prompt input_prompt">
    </div>
    <div class="inner_cell">
     <div class="text_cell_render border-box-sizing rendered_html">
     </div>
    </div>
   </div>

</div>
