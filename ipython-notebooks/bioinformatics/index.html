<!DOCTYPE html>
<html>
	    <head>

        <meta charset="utf-8" />

    	<!-- Fonts -->
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//fonts/font-awesome/css/font-awesome.min.css" />
        <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/plotly_icons.css" />
        <link href="//fonts.googleapis.com/css?family=Open+Sans:600,400,300,200|Inconsolata|Ubuntu+Mono:400,700" rel="stylesheet" type="text/css" />


    	<!-- Stytlesheets -->
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/normalize.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/base.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/layout_block.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/modules.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/state.css">
    	<!-- Download icon for Plotly.js -->
	   <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        
        <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/api_docs.css">
        
        

    	<!-- Icon -->
    	<link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" type="image/x-icon" />

    	<!-- META TAGS -->
    	<!-- SEO Tags - title, meta_description -->
    <title>Bioinformatics</title>
    <meta name="description" content="5 popular visualizations that bioinformaticians use in exploratory analysis of genomic data.">

<!-- Bing tags -->
    <meta name="msvalidate.01" content="D319859A832F9F1D15A7646E2A42150A" />
<!-- Facebook tags -->
    <meta property="og:title" content="Visualizing biological data&#58; exploratory bioinformatics with plot.ly"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://plot.ly/gh-pages/documentation/static//images/static-image">
    <meta property="og:description" content="5 popular visualizations that bioinformaticians use in exploratory analysis of genomic data."/>
    <meta property="og:url" />
    <meta property="fb:admins" content="1123751525"/>
    <meta property="fb:admins" content="22418"/>

<!-- twitter tags -->
    <meta name="twitter:card" content="photo" />
    <meta name="twitter:title" content="Visualizing biological data&#58; exploratory bioinformatics with plot.ly"/>
    <meta name="twitter:url" content="http://help.plot.ly/ipython-notebooks/bioinformatics"/>
    <meta name="twitter:description" content="5 popular visualizations that bioinformaticians use in exploratory analysis of genomic data."/>
    <meta name="twitter:image" content="https://plot.ly/gh-pages/documentation/static//images/static-image">
    <meta name="twitter:site" content="@plotlygraphs"/>

<!-- Favicon -->
    <link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" />



    	<!-- code highlighting -->
    	<link rel="stylesheet" href="https://plot.ly/gh-pages/documentation/static//javascripts/codehighlight/styles/tomorrow.css">

	<!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
	for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
	mixpanel.init("ad6df61d0b9400400b240631576c24d4");</script><!-- end Mixpanel -->

	</head>

	<head>
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/state.css">
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/ipython-notebook-base.css">
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/ipython-notebook-custom.css">
	</head>

	<body>
		<div class="allcontent">
			<div class="headerbar">

  <div class="headerbar-leftside">
      <a href="https://plot.ly/feed/" class="logo">
          <i class="ploticon-plotlylogo"></i>
          <em>plotly</em>
      </a>
  </div>

  <div class="headerbar-rightside hidesmall">

      <a class="button" href="https://plot.ly/plot">
        &plus; NEW PROJECT
      </a>

      <a class="button" href="https://plot.ly/products/cloud/">
        UPGRADE
      </a>
  </div>

  <div class="headerbar-nav hidesmall">

      <a href="https://plot.ly/feed/" target="_self">
      <span class="headerbar-nav-item ">Explore</span>
      </a>

      <a href="https://plot.ly/products/cloud/" target="_self">
      <span class="headerbar-nav-item ">Pricing</span></span>
      </a>

      <a href="https://plot.ly/products/industries/" onmouseover="dropDownMenu('industries-nav')" onmouseout="hideDropDownMenu('industries-nav')" target="_self">
      <span class="headerbar-nav-item ">Industries</span><span class="caret"></span>
      </a>

          <nav id="industries-nav" role="menu" class="dropdown-menu" onmouseover="dropDownMenu('industries-nav')" onmouseout="hideDropDownMenu('industries-nav')" style="display:none; margin-left: 50px;">
              <a href="https://plot.ly/products/industries/finance/" class="dropdown-menu-item" target="_self">FINANCE</a>
              <a href="https://plot.ly/products/industries/insurance/" class="dropdown-menu-item" target="_self">INSURANCE</a>
              <a href="https://plot.ly/products/industries/aerospace/" class="dropdown-menu-item" target="_self">AEROSPACE</a>
              <a href="https://plot.ly/products/industries/energy/" class="dropdown-menu-item" target="_self">ENERGY</a>
              <a href="https://plot.ly/products/industries/research-and-development/" class="dropdown-menu-item" target="_self">RESEARCH &amp; DEVELOPMENT</a>
              <a href="https://plot.ly/products/industries/automotive/" class="dropdown-menu-item" target="_self">AUTOMOTIVE</a>
              <a href="https://plot.ly/products/industries/government-and-public/" class="dropdown-menu-item" target="_self">GOVERNMENT</a>
              <a href="https://plot.ly/products/industries/pharma/" class="dropdown-menu-item" target="_self">PHARMA &amp; COMPUTATIONAL BIOLOGY</a>
              <a href="https://plot.ly/products/industries/journalism/" class="dropdown-menu-item" target="_self">JOURNALISM</a>
              <a href="https://plot.ly/products/industries/business-intelligence/" class="dropdown-menu-item" target="_self">BUSINESS INTELLIGENCE</a>
          </nav>

      <a href="https://plot.ly/api/" onmouseover="dropDownMenu('api-menu')" onmouseout="hideDropDownMenu('api-menu')" target="_self">
      <span class="headerbar-nav-item ">API</span><span class="caret"></span>
      </a>

          <nav id="api-menu" role="menu" class="dropdown-menu" onmouseover="dropDownMenu('api-menu')" onmouseout="hideDropDownMenu('api-menu')" style="display:none; margin-left: 225px;">
              <a href="/python" class="dropdown-menu-item" target="_self">PYTHON</a>
              <a href="/r" class="dropdown-menu-item" target="_self">R</a>
              <a href="/matlab" class="dropdown-menu-item" target="_self">MATLAB</a>
              <a href="/javascript-graphing-library" class="dropdown-menu-item" target="_self">JAVASCRIPT</a>
              <a href="/api" class="dropdown-menu-item" target="_self">MORE</a>
          </nav>

  </div>

  <div class="hamburger">
    <a href='#popmenufull' onclick='return clickfullmenu();'>
      <img src="http://i.imgur.com/o7Mxj6T.png" alt="Menu" id="hamburgerlink" onmouseover="this.src='http://i.imgur.com/gj2TtuI.png'" onmouseout="this.src='http://i.imgur.com/o7Mxj6T.png'">
    </a>

  </div>

</div>

<!-- POP UP MENU -->
  <div id="popmenufull" style="display:none;">
      <div class="popupheader">
          <div class="headerbar-leftside">
            <a href="/feed/" class="logo">
              <i class="ploticon-plotlylogo"></i>
              <em>plotly</em>
            </a>
          </div>
          <a href='#popmenufull' onclick='return clickfullmenu();'>
          <div class="close"><img alt="close" src="http://i.imgur.com/esVZHwn.png"></div> </a>
      </div>

      <div class="popupmenu">
        <ul>
          <li><a href="https://plot.ly/feed/">Explore</a></li>
          <li><a href="https://plot.ly/products/cloud/">Pricing</a></li>

          <div onmouseover="dropDownMenu('sub-industries')" onmouseout="hideDropDownMenu('sub-industries')">
            <li><a href="https://plot.ly/products/industries/">Industries</a></li>
            <div class="sub-popmenu" id="sub-industries" style="display:none;">
                <ul class="no-margin">
                  <li class="no-margin"><a href="https://plot.ly/products/industries/finance/">FINANCE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/insurance/">INSURANCE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/aerospace/">AEROSPACE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/energy/">ENERGY</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/research-and-development/">RESEARCH &amp; DEVELOPMENT</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/automotive/">AUTOMOTIVE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/government-and-public/">GOVERNMENT</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/pharma/">PHARMA &amp; COMPUTATIONAL BIOLOGY</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/journalism/">JOURNALISM</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/business-intelligence/">BUSINESS INTELLIGENCE</a></li>
                </ul>
            </div>
          </div>
          <div onmouseover="dropDownMenu('sub-api')" onmouseout="hideDropDownMenu('sub-api')">
            <li><a href="https://plot.ly/api/">API</a></li>
            <div class="sub-popmenu" id="sub-api" style="display:none;">
              <ul class="no-margin">
                <li class="no-margin"><a href="/python">PYTHON</a></li>
                <li class="no-margin"><a href="/r">R</a></li>
                <li class="no-margin"><a href="/matlab">MATLAB</a></li>
                <li class="no-margin"><a href="/javascript">JAVASCRIPT</a></li>
                <li class="no-margin"><a href="/api">MORE</a></li>
              </ul>
            </div>
          </div>
        </ul>
      </div>

  </div>

  <!-- POPUP MENU FULL PAGE -->
  <script>
  function clickfullmenu(){
    var thediv=document.getElementById('popmenufull');
    if(thediv.style.display == "none"){
      thediv.style.display = "";
    }else{
      thediv.style.display = "none";
    }
    return false;
  };
  </script>

  <!-- Drop Down Menu -->
  <script>
  function dropDownMenu(divID){
    var chosenDiv = document.getElementById(divID);
    console.log(chosenDiv);
    if(chosenDiv.style.display == "none"){
      chosenDiv.style.display = "block";
    }
  };
  function hideDropDownMenu(divID){
    var chosenDiv = document.getElementById(divID);
    console.log(chosenDiv);
    if(chosenDiv.style.display == "block"){
      chosenDiv.style.display = "none";
    }
  }
  </script>

				
    
    <div style="background-image: url(https://plot.ly/gh-pages/documentation/static//images/banner-bar.png);height: 170px;text-align: center;">
    	<div style="background-color: rgba(255,255,255,0.8); height: 100%; text-align: center;">
            <div style="text-align: center;position: relative; padding-top: 5px;">
        	    <h6 style="color: black;">plotly is free for unlimited public use</h6>
                <a class="button" href="https://plot.ly/products/cloud/" target="_blank" style="text-decoration: none;font-size: 14px;padding: 12px 24px;">SIGN UP FOR FREE</a>
        	    <h6 style="color: black;" style="text-align: center;">
        		    Sensitive data? Upgrade to a <a href="https://plot.ly/products/cloud/">paid plan</a>
        	    </h6>
            </div>
        </div>
    </div>



			<div class="navigation-bar">

    <p class="align-left padding_left_small"><a href="http://help.plot.ly/"><i class="fa fa-life-ring"></i> Help</a><span>/</span><a href="/api/">API Libraries</a><span>/</span><a href="/python"  >Python</a><span>/</span><a href="#">Visualizing biological data&#58; exploratory bioinformatics with plot.ly</a></p>

    <div class="float-right padding_right_small" style="margin-top:10px;">
        <a id="forklink" href="https://github.com/plotly"><i class="fa fa-github-alt"></i> Fork on GitHub</a>
    </div>

</div>


			<div class="sectionseparator_white">
				<div class="container">



					
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Visualizing-biological-data:-exploratory-bioinformatics-with-plot.ly">Visualizing biological data: exploratory bioinformatics with plot.ly<a class="anchor-link" href="#Visualizing-biological-data:-exploratory-bioinformatics-with-plot.ly">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="About-the-author:">About the author:<a class="anchor-link" href="#About-the-author:">&#182;</a></h4><p>Oxana is a data scientist based in Stockholm, Sweden. She is studying for a PhD in Bioinformatics, exploring molecular evolution patterns in eukaryotes. You can follow Oxana on Twitter <a href="http://twitter.com/Merenlin">@Merenlin</a> or read <a href="http://merenlin.com">her blog</a>.</p>
<h3 id="Introduction">Introduction<a class="anchor-link" href="#Introduction">&#182;</a></h3><p>This notebook will give you the recipes of the most popular data visualizations I encounter in my work as a bioinformatician. If you always wondered what bioinformatics is all about or would like to create interactive
visualization for your genomic data using <a href="https://plot.ly/python/">plot.ly</a>, this is the place to start.</p>
<p>We will be working with real <a href="http://en.wikipedia.org/wiki/Gene_expression">gene expression</a> data obtained by <a href="http://en.wikipedia.org/wiki/Cap_analysis_gene_expression">Cap Analysis of Gene Expression(CAGE)</a> from human samples by the <a href="http://fantom.gsc.riken.jp/5/">FANTOM5</a> consortium. We will be following a typical workflow of a bioinformatician exploring new data, looking for the outliers: interesting genes or samples, or general patterns in the data. In the end, you'll get the idea of the challenges and upsides of creating interactive visualizations of biological data using plot.ly Python API.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Obtaining-the-data">Obtaining the data<a class="anchor-link" href="#Obtaining-the-data">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>FANTOM5 provides high precision data of thousands of human and mouse samples. The vastness of this data can be overwhelming and operating it locally is challenging. Luckily, there are many tools out there to make our life easier.<br>
For creating a small data subset we can work with in this tutorial, I used <a href="http://fantom.gsc.riken.jp/5/tet">TET: Fantom 5 Table Extraction tool</a>. I picked a few human samples, mostly brain tissues with a few outliers, like uterus and downloaded a tab-separated file from the website. For more advanced data extraction, it's good to have a look at <a href="https://github.com/Hypercubed/TET/blob/master/README.md">TET's API</a>. 
I have picked normalized tpm(tags per million) and annotated data, so we can focus only on processed data for protein coding genes. All data files for this notebook are available on figshare: <a href="http://dx.doi.org/10.6084/m9.figshare.1430029">http://dx.doi.org/10.6084/m9.figshare.1430029</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loading-the-dataset">Loading the dataset<a class="anchor-link" href="#Loading-the-dataset">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are loading the data from the .tsv file, skipping the first two columns (00Annotation and short_description).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s">&quot;http://figshare.com/download/file/2087487/1&quot;</span><span class="p">,</span>
                     <span class="n">comments</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">names</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="s">&quot;Number of genes: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of genes: 201802
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[47]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uniprot_id</th>
      <th>Astrocyte__cerebellum_donor1CNhs1132111500119F6</th>
      <th>Astrocyte__cerebral_cortex_donor1CNhs1086411235116D2</th>
      <th>brain_adult_donor1CNhs1179610084102B3</th>
      <th>brain_adult_pool1CNhs1061710012101C3</th>
      <th>brain_fetal_pool1CNhs1179710085102B4</th>
      <th>breast_adult_donor1CNhs1179210080102A8</th>
      <th>cerebellum__adult_donor10196CNhs1379910173103C2</th>
      <th>cerebellum_adult_donor10252CNhs1232310166103B4</th>
      <th>cerebellum_newborn_donor10223CNhs1407510357105E6</th>
      <th>...</th>
      <th>thalamus__adult_donor10196CNhs1379410168103B6</th>
      <th>thalamus_adult_donor10252CNhs1231410154103A1</th>
      <th>thalamus_adult_donor10258_tech_rep1CNhs1422310370105G1</th>
      <th>thalamus_adult_donor10258_tech_rep2CNhs1455110370105G1</th>
      <th>thalamus_newborn_donor10223CNhs1408410366105F6</th>
      <th>throat_fetal_donor1CNhs1177010061101H7</th>
      <th>thyroid_fetal_donor1CNhs1176910060101H6</th>
      <th>tongue_epidermis_fungiform_papillae_donor1CNhs1346010288104F9</th>
      <th>umbilical_cord_fetal_donor1CNhs1176510057101H3</th>
      <th>uterus_fetal_donor1CNhs1176310055101H1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>             NA</td>
      <td>    0</td>
      <td>     0</td>
      <td> 0</td>
      <td> 0</td>
      <td> 0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>...</td>
      <td>   0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
    </tr>
    <tr>
      <th>1</th>
      <td> uniprot:Q96JB6</td>
      <td> 0.12</td>
      <td> 11.45</td>
      <td> 0</td>
      <td> 0</td>
      <td> 0</td>
      <td> 2.17</td>
      <td> 0</td>
      <td> 0.22</td>
      <td> 1.03</td>
      <td>...</td>
      <td> 5.8</td>
      <td> 0.31</td>
      <td> 5.65</td>
      <td> 2.99</td>
      <td> 0</td>
      <td> 1.19</td>
      <td> 1.01</td>
      <td> 2.58</td>
      <td> 7.04</td>
      <td> 4.48</td>
    </tr>
    <tr>
      <th>2</th>
      <td>             NA</td>
      <td>    0</td>
      <td>     0</td>
      <td> 0</td>
      <td> 0</td>
      <td> 0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>...</td>
      <td>   0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>             NA</td>
      <td>    0</td>
      <td>     0</td>
      <td> 0</td>
      <td> 0</td>
      <td> 0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>...</td>
      <td>   0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>             NA</td>
      <td>    0</td>
      <td>     0</td>
      <td> 0</td>
      <td> 0</td>
      <td> 0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>...</td>
      <td>   0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td> 0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
      <td>    0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 71 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's also make sure that we filter out those genes for which the <a href="http://www.uniprot.org/">Uniprot</a> Id is unknown. That will reduce our data, besides, we are only interested in proteins in this analysis.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">uniprot_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;uniprot_id&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">!=</span> <span class="s">&#39;NA&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">x</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">))]</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s">&quot;uniprot_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">uniprot_clean</span><span class="p">)]</span>
<span class="k">print</span> <span class="s">&quot;Number of genes: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of genes: 59173
</pre>
</div>
</div>

<div class="output_area"><div class="prompt output_prompt">Out[48]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>uniprot_id</th>
      <th>Astrocyte__cerebellum_donor1CNhs1132111500119F6</th>
      <th>Astrocyte__cerebral_cortex_donor1CNhs1086411235116D2</th>
      <th>brain_adult_donor1CNhs1179610084102B3</th>
      <th>brain_adult_pool1CNhs1061710012101C3</th>
      <th>brain_fetal_pool1CNhs1179710085102B4</th>
      <th>breast_adult_donor1CNhs1179210080102A8</th>
      <th>cerebellum__adult_donor10196CNhs1379910173103C2</th>
      <th>cerebellum_adult_donor10252CNhs1232310166103B4</th>
      <th>cerebellum_newborn_donor10223CNhs1407510357105E6</th>
      <th>...</th>
      <th>thalamus__adult_donor10196CNhs1379410168103B6</th>
      <th>thalamus_adult_donor10252CNhs1231410154103A1</th>
      <th>thalamus_adult_donor10258_tech_rep1CNhs1422310370105G1</th>
      <th>thalamus_adult_donor10258_tech_rep2CNhs1455110370105G1</th>
      <th>thalamus_newborn_donor10223CNhs1408410366105F6</th>
      <th>throat_fetal_donor1CNhs1177010061101H7</th>
      <th>thyroid_fetal_donor1CNhs1176910060101H6</th>
      <th>tongue_epidermis_fungiform_papillae_donor1CNhs1346010288104F9</th>
      <th>umbilical_cord_fetal_donor1CNhs1176510057101H3</th>
      <th>uterus_fetal_donor1CNhs1176310055101H1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1 </th>
      <td>                               uniprot:Q96JB6</td>
      <td>  0.12</td>
      <td> 11.45</td>
      <td>     0</td>
      <td>     0</td>
      <td>     0</td>
      <td> 2.17</td>
      <td>     0</td>
      <td>  0.22</td>
      <td>  1.03</td>
      <td>...</td>
      <td>   5.8</td>
      <td>  0.31</td>
      <td> 5.65</td>
      <td>  2.99</td>
      <td>     0</td>
      <td>  1.19</td>
      <td>  1.01</td>
      <td> 2.58</td>
      <td>  7.04</td>
      <td>  4.48</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>                               uniprot:Q8N2H3</td>
      <td>  7.51</td>
      <td>   6.3</td>
      <td>  3.88</td>
      <td>  3.71</td>
      <td>     2</td>
      <td> 5.07</td>
      <td>  1.53</td>
      <td>  1.99</td>
      <td>  6.72</td>
      <td>...</td>
      <td>  4.15</td>
      <td>  7.34</td>
      <td> 4.23</td>
      <td>  3.84</td>
      <td>  4.28</td>
      <td> 15.24</td>
      <td> 11.92</td>
      <td> 7.74</td>
      <td>  7.04</td>
      <td> 15.87</td>
    </tr>
    <tr>
      <th>7 </th>
      <td>                               uniprot:Q8N2H3</td>
      <td>  3.69</td>
      <td>  3.43</td>
      <td>  1.94</td>
      <td>  0.65</td>
      <td>     0</td>
      <td>    0</td>
      <td>  1.53</td>
      <td>  0.55</td>
      <td>  1.55</td>
      <td>...</td>
      <td>  0.83</td>
      <td>  2.69</td>
      <td> 2.82</td>
      <td>  1.92</td>
      <td>     0</td>
      <td>  3.33</td>
      <td>  3.03</td>
      <td> 2.58</td>
      <td>  2.35</td>
      <td>  5.29</td>
    </tr>
    <tr>
      <th>14</th>
      <td> uniprot:Q92902,uniprot:Q658M9,uniprot:Q8WXE5</td>
      <td> 35.58</td>
      <td> 20.61</td>
      <td> 30.05</td>
      <td> 21.71</td>
      <td> 19.96</td>
      <td> 31.9</td>
      <td> 13.73</td>
      <td> 20.79</td>
      <td> 21.72</td>
      <td>...</td>
      <td> 15.75</td>
      <td> 26.89</td>
      <td>   24</td>
      <td> 26.24</td>
      <td> 12.83</td>
      <td> 19.76</td>
      <td> 22.03</td>
      <td> 12.9</td>
      <td> 32.85</td>
      <td> 17.09</td>
    </tr>
    <tr>
      <th>23</th>
      <td>                               uniprot:Q8WWQ2</td>
      <td>     0</td>
      <td>     0</td>
      <td>     0</td>
      <td>  1.02</td>
      <td>     0</td>
      <td>    0</td>
      <td>     0</td>
      <td>  2.99</td>
      <td>     0</td>
      <td>...</td>
      <td>   5.8</td>
      <td>  8.38</td>
      <td> 4.23</td>
      <td>  8.96</td>
      <td>  0.71</td>
      <td>  0.71</td>
      <td>     0</td>
      <td>    0</td>
      <td>  7.04</td>
      <td>   5.7</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 71 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-MA-scatter-plot-comparing-newborn-and-adult-tissues">1. MA scatter plot comparing newborn and adult tissues<a class="anchor-link" href="#1.-MA-scatter-plot-comparing-newborn-and-adult-tissues">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="http://en.wikipedia.org/wiki/MA_plot">MA plot</a> is a popular visualization tool coming from the microarray analysis. It allows researchers to explore true statistical differences between the two samples, arrays or other observations. We are going to look at the two samples of substantia nigra tissues from the brain of an adult and a newborn person. How do their genetic profiles differ?</p>
<p>Firs, let's subset our big dataframe to only include the samples of interest. We will also prefilter the data to not include genes that are not expressed in these tissues.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">df_MA</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s">&quot;uniprot_id&quot;</span><span class="p">,</span><span class="s">&#39;substantia_nigra_adult_donor10258CNhs1422410371105G2&#39;</span><span class="p">,</span><span class="s">&#39;substantia_nigra_newborn_donor10223CNhs1407610358105E7&#39;</span><span class="p">]]</span>
<span class="n">df_MA</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;gene&#39;</span><span class="p">,</span><span class="s">&#39;adult&#39;</span><span class="p">,</span> <span class="s">&#39;newborn&#39;</span><span class="p">]</span>
<span class="n">df_MA</span><span class="p">[[</span><span class="s">&#39;adult&#39;</span><span class="p">,</span><span class="s">&#39;newborn&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_MA</span><span class="p">[[</span><span class="s">&#39;adult&#39;</span><span class="p">,</span> <span class="s">&#39;newborn&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> 
<span class="n">df_MA</span> <span class="o">=</span> <span class="n">df_MA</span><span class="p">[(</span><span class="n">df_MA</span><span class="o">.</span><span class="n">T</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>  <span class="c">#remove rows with all zeros</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are many different methods of computing the average expression level(A) between the two observations and
the mean variation(M). To keep things simple, for this example we will just compare the sum on the x-axis vs the minus on the y-axis.
Our data is already normalized and preprocessed, so this will be enough to find the clear outliers.</p>
<p>Here lies the firs problem with web-based interactive visualizations. Plot.ly at the moment has a very hard time rendering more than 40k points in a scatter plot. So for the sake of this example, I'll plot a subset of the data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="kn">as</span> <span class="nn">py</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">df_MA</span><span class="p">[</span><span class="s">&#39;adult&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_MA</span><span class="p">[</span><span class="s">&#39;newborn&#39;</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">df_MA</span><span class="p">[</span><span class="s">&#39;adult&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_MA</span><span class="p">[</span><span class="s">&#39;newborn&#39;</span><span class="p">]</span>

<span class="n">trace</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&quot;substantia nigra&quot;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="n">df_MA</span><span class="p">[</span><span class="s">&#39;gene&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>

<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s">&quot;MA plot of gene expression in adult and newborn samples of substantia nigra&quot;</span><span class="p">,</span>
                <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="s">&#39;A&#39;</span><span class="p">,</span>
                <span class="p">),</span>
               <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span>
                    <span class="n">title</span><span class="o">=</span><span class="s">&#39;M&#39;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">([</span><span class="n">trace</span><span class="p">]),</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[50]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~oxana/253.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can already start exploring some of the genes, that behave differently in adult vs newborn samples.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-Histograms-of-expression-breadth-and-average-expression-levels">2. Histograms of expression breadth and average expression levels<a class="anchor-link" href="#2.-Histograms-of-expression-breadth-and-average-expression-levels">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another timeless visualization for exploratory data analysis is histogram. Here we don't need to subset our data anymore, for plots like these Plot.ly's capacity is up to 100k points. Let's see how expression breadth(in how many tissues the gene is expressed) and average expression levels look like for all of the samples.</p>
<p>Just use the "domain" variable to regulate where the axis of each subplot are.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">df</span><span class="p">[</span><span class="s">&#39;breadth&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;float&#39;</span><span class="p">)</span>

<span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s">&#39;avg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s">&#39;float&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">trace1</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s">&quot;expression breadth&quot;</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;breadth&#39;</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="s">&#39;grey&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span>
        <span class="p">),</span>
<span class="p">)</span>

<span class="n">trace2</span> <span class="o">=</span> <span class="n">Histogram</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s">&quot;average expression&quot;</span><span class="p">,</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;avg&#39;</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="s">&#39;grey&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.75</span>
        <span class="p">),</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="s">&#39;x2&#39;</span><span class="p">,</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="s">&#39;y2&#39;</span>
    <span class="p">)</span>


<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&quot;Exploring the distributions&quot;</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s">&#39;breadth&#39;</span><span class="p">,</span>
         <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">]</span>
    <span class="p">),</span>
    <span class="n">xaxis2</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s">&#39;average expression&#39;</span><span class="p">,</span>
        <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mf">0.55</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">),</span> 
    <span class="n">yaxis2</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span>
        <span class="n">anchor</span><span class="o">=</span><span class="s">&#39;x2&#39;</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">([</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">]),</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[51]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~oxana/254.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is where interactive visualization comes in handy. Average expression level distribution looks very wide because of a few outliers, - highly expressed genes and most of the genes actually being expressed at a very low level. But instead of trying to adjust the limits on the x-axis, we can just zoom in on the interesting area. Try it!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-Scatter-plot-with-a-trend-line">3. Scatter plot with a trend line<a class="anchor-link" href="#3.-Scatter-plot-with-a-trend-line">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This kind of plot must be the most popular way to visualize a trend in biological data. We seek clear
and simple patterns demonstrating the relationships between different biological parameters or observations.
Plot.ly's Python API does not come with out-of-the-box tools for plotting trend lines, but numpy has all we need.</p>
<p>Let's say we want to plot the relationship between the breadth of expression and the average level. Again, for speed and simplicity, we only take the first 1000 genes in our data frame. Let's try to fit a polinomial function to our data points and plot both at the same time. By using plot.ly it's simple, just send the regression line trace to the same figure.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;breadth&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">&#39;avg&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">]</span>
<span class="n">coefficients</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">polynomial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">coefficients</span><span class="p">)</span>
<span class="n">r_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">r_y</span> <span class="o">=</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">r_x</span><span class="p">)</span>

<span class="n">trace1</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s">&#39;markers&#39;</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&quot;expression levels&quot;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">&#39;uniprot_id&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">1000</span><span class="p">],</span>
    <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="s">&#39;rgba(217, 217, 217, 0.14)&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">))</span>

<span class="n">trace2</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span>
    <span class="n">mode</span><span class="o">=</span><span class="s">&#39;lines+markers&#39;</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="n">r_x</span><span class="p">,</span> 
    <span class="n">y</span><span class="o">=</span><span class="n">r_y</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="n">Line</span><span class="p">(</span>
            <span class="n">color</span><span class="o">=</span><span class="s">&#39;purple&#39;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&quot;breadth regression&quot;</span><span class="p">)</span>

<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&quot;Breadth of expression vs average expression level&quot;</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s">&#39;breadth&#39;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s">&#39;average expression&#39;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">([</span><span class="n">trace1</span><span class="p">,</span> <span class="n">trace2</span><span class="p">]),</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[52]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~oxana/255.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-Heatmap-of-gene-expression">4. Heatmap of gene expression<a class="anchor-link" href="#4.-Heatmap-of-gene-expression">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Heatmap is another great way to visualize big amounts of data. It allows to clearly see the outliers and explore the 
general clustering patterns. Are genes in different tissues, but the same donor expressed similarly or do the same tissues
from different donors tend to cluster together? Do brains of newborns and adults differ in gene expression patterns? 
Heatmaps of gene expression can give you good leads to questions like these.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is one catch with generating a heatmap for biological samples using plot.ly. Labels of the heatmap will actually
be coordinates on the x and y axis. For the plot to look less cluttered, I have removed the grid and set dtick to 1. Setting autotick to False also proved useful in order to see all the samples correctly labeled.</p>
<p>To improve readability, one often also needs to process samples names. In our data, as you probably noticed, sample names include everything: tissue name, annotation, donor, age. The name becomes long and impossible to display in a plot. Simple shortening will not work with plot.ly though, since the coordinates must be unique!</p>
<p>For this tutorial I've cheated a bit, by just adding an integer to each shortened name, I'm sure you can handle the string processing of your samples names on your own ;-)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">from</span> <span class="nn">scipy.spatial.distance</span> <span class="kn">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">squareform</span>

<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;breadth&#39;</span><span class="p">,</span> <span class="s">&#39;uniprot_id&#39;</span><span class="p">,</span> <span class="s">&#39;avg&#39;</span><span class="p">]]</span>
<span class="n">short_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">]</span>
<span class="n">short_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">short_cols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">short_cols</span><span class="p">),</span><span class="mi">1</span><span class="p">)]</span>
<span class="n">data_dist</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">([</span>
    <span class="n">Heatmap</span><span class="p">(</span>
        <span class="n">z</span><span class="o">=</span><span class="n">squareform</span><span class="p">(</span><span class="n">data_dist</span><span class="p">),</span> <span class="n">colorscale</span><span class="o">=</span><span class="s">&#39;YIGnBu&#39;</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="n">short_cols</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">short_cols</span><span class="p">,</span>     <span class="c"># y-axis labels</span>
    <span class="p">)</span>
<span class="p">])</span>

<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&#39;Transcription profiling of human brain samples&#39;</span><span class="p">,</span>
    <span class="n">autosize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="n">Margin</span><span class="p">(</span>
        <span class="n">l</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">b</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">pad</span><span class="o">=</span><span class="mi">4</span>
    <span class="p">),</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span>
        <span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="c"># remove grid</span>
        <span class="n">autotick</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="c"># custom ticks</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>        <span class="c"># show 1 tick per day</span>
    <span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span>
        <span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>   <span class="c"># remove grid</span>
        <span class="n">autotick</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>   <span class="c"># custom ticks</span>
        <span class="n">dtick</span><span class="o">=</span><span class="mi">1</span>           <span class="c"># show 1 tick per day</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[53]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~oxana/256.embed?width=875&height=875" height="900" width="900"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.-Network-of-gene-interactions">5. Network of gene interactions<a class="anchor-link" href="#5.-Network-of-gene-interactions">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now at some point in our biological investigations, we've got to dig deeper and look at concrete genes/proteins we found interesting.</p>
<p>If you go back to our first plot, you'll see that one of the points that stand out corresponds to Q16352(Alpha-internexin, AINX_HUMAN). This gene demonstrates both high level of expression in substantia nigra and the difference between adult and newborn samples is also significant. Which kind of makes sense, since this protein is involved in the morphogenesis of neurons. One of the ways to find out more about a protein is to look at it's interaction networks.</p>
<p>I've downloaded the interaction network in tab-separated format from a popular database <a href="http://string-db.org/">string-db.org</a>, so there is nothing novel in plotting it, we are merely reproducing the graph on their website, but, hopefully, you'll be able to use it for your future contributions to science!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">networkx</span> <span class="kn">as</span> <span class="nn">nx</span>

<span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="kn">as</span> <span class="nn">py</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s">&#39;http://figshare.com/download/file/2088824&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span>
                  <span class="n">dtype</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;S5&#39;</span><span class="p">,</span><span class="s">&#39;S5&#39;</span><span class="p">,</span><span class="s">&#39;f8&#39;</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>

<span class="n">G</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_weighted_edges_from</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">pos</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

<span class="n">edge_trace</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[],</span> <span class="n">y</span><span class="o">=</span><span class="p">[],</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;lines&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> 
    <span class="n">edge_trace</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">edge_trace</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>

<span class="n">node_trace</span> <span class="o">=</span> <span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[],</span> <span class="n">y</span><span class="o">=</span><span class="p">[],</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;markers+text&#39;</span><span class="p">,</span>
                     <span class="n">text</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span>
                     <span class="n">textposition</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span>
                     <span class="n">marker</span><span class="o">=</span><span class="n">Marker</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="n">node_trace</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">node_trace</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
   
<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">([</span><span class="n">edge_trace</span><span class="p">,</span> <span class="n">node_trace</span><span class="p">]),</span>
             <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;AINX_HUMAN interaction network&#39;</span><span class="p">,</span>
                           <span class="n">showlegend</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">zeroline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">showticklabels</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
                           <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">zeroline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">showticklabels</span><span class="o">=</span><span class="bp">False</span><span class="p">)))</span>

<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[54]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~oxana/257.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you see our protein under it's gene name(INA) in the center of the graph.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, that's all, folks! I hope you enjoyed this intro to exploratory bioinformatics and got inspired to create beautiful interactive visualizations for your biological data.</p>

</div>
</div>
</div>

				</div>
			</div>
		</div>
    <footer>
<div class="plotly-footer">
	<div style="
    background-image: url('http://images.plot.ly/background-images/grey-chart-background.png');
    height: 200px;
    font-family: 'Open sans',verdana,arial,sans-serif;
    position: relative;">

<h2 style="
    text-align: center;
    background-color: rgba(255,255,255,0.9);
    margin: 0px;
    padding-top: 20px;
    font-family: 'Open sans',verdana,arial,sans-serif;">upgrade to pro</h2>

<h5 style="
    text-align: center;
    background-color: rgba(255,255,255,0.9);
    margin: 0;
    padding: 20px 0px;
    color: black;
    font-family: 'Open sans',verdana,arial,sans-serif;">unlimited private files & email support</h5>

<div style="
    text-align: center;
    height: 50%;
    font-family: 'Open sans',verdana,arial,sans-serif;
    background-color: rgba(255,255,255,0.9);">

<a class="button trial-offline-cta" href="https://plot.ly/products/cloud/">$20 per month</a>

</div>
</div>

	<div class="row footerarea footer-top">
		<div class="one column footcolumn space"> </div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">API</h6>
			<ul>
				<li><a  href="https://plot.ly/api/" target="_self">Documentation</a></li>
				<li><a  href="https://plot.ly/api/" target="_self">API Libraries</a></li>
				<li><a  href="https://plot.ly/rest/" target="_self">REST APIs</a></li>
				<li><a  href="https://plot.ly/javascript/" target="_self">Plotly.js</a></li>
				<li><a  href="https://plot.ly/workshop/" target="_self">Hardware</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">About Us</h6>
			<ul>
				<li><a href="https://plot.ly/company/team/" target="_self">Team</a></li>
				<li><a href="https://plot.ly/company/jobs/" target="_self">Careers</a></li>
				<li><a href="http://blog.plot.ly" target="_blank">Plotly Blog</a></li>
				<li><a href="http://moderndata.plot.ly" target="_blank">Modern Data</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">Help</h6>
			<ul>
				<li><a href="https://plot.ly/learn/" target="_self">Knowledge Base</a></li>
				<li><a href="https://plot.ly/benchmarks/" target="_self">Benchmarks</a></li>
				<li><a href="https://plot.ly/workshop/" target="_self">Workshop</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">Solutions</h6>
			<ul>
				<li><a href="https://plot.ly/product/plans/" target="_self">Plans &amp; Pricing</a></li>
				<li><a href="https://plot.ly/product/enterprise/" target="_self">Enterprise</a></li>
				<li><a href="https://plot.ly/online-graphing-and-statistics-for-educators/" target="_self">Education</a></li>
				<li><a href="https://plot.ly/product/plotlyjs/" target="_self">Plotly.js</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
     		<h6 class="footer-heading">Connect</h6>
			<ul class="plotly-social-media-small">
				<li><a href="//twitter.com/plotlygraphs" target="_blank"><i class="icon-twitter social_icon"></i></a></li>
				<li><a href="//www.facebook.com/Plotly" target="_blank"><i class="icon-facebook social_icon"></i></a></li>
				<li><a href="//github.com/plotly" target="_blank"><i class="icon-github social_icon"></i></a></li>
				<li><a href="//linkedin.com/company/plotly" target="_blank"><i class="icon-linkedin social_icon"></i></a></li>
				<li><a href="//plus.google.com/+PlotLy" target="_blank"><i class="icon-google-plus  social_icon"></i></a></li>
			</ul>
		</div>
		<div class="one column footcolumn"></div>
	</div>

	<div class="row footerarea footer-bottom">
		<div class="one column footcolumn space"> </div>
		<div class="four columns footcolumn"><p>Copyright &copy; 2015 Plotly. All rights reserved.</p></div>
		<div class="two columns footcolumn"><a href="https://plot.ly/terms-of-service/" target="_blank" ><p>Terms of Service</p></a></div>
		<div class="two columns footcolumn"><a href="https://plot.ly/privacy/" target="_blank"><p>Privacy Policy</p></a></div>


	</div>
</div>
</footer>

<!-- Mathjax -->
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}});
</script>
<script type='text/javascript' src='//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML%2CSafe.js&#038;ver=4.1'></script>

<!-- Image Hover Script -->
<script src="https://plot.ly/gh-pages/documentation/static//javascripts/imghover.js"></script>

<!-- code highlighting -->
<script src="https://plot.ly/gh-pages/documentation/static//javascripts/codehighlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-39373211-1', 'auto');
  ga('send', 'pageview');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-39373211-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
mixpanel.init("ad6df61d0b9400400b240631576c24d4");</script><!-- end Mixpanel -->

<script type="text/javascript">
    mixpanel.track("Page visit", {
        "url_group": "API docs - GitHub pages",
        "url": window.location.pathname
    });
</script>

<script type="text/javascript">
function getQueryParam(param) {
    param = param.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + param + "=([^&#]*)",
        regex = new RegExp( regexS ),
        results = regex.exec(document.URL);
    if (results === null || (results && typeof(results[1]) !== 'string' && results[1].length)) {
        return '';
    } else {
        return decodeURIComponent(results[1]).replace(/\+/g, ' ');
    }
};
</script>

<script type="text/javascript">
    var visit_origin = getQueryParam("campaign_id");

    mixpanel.register({
        "email_campaign_received": visit_origin
    });

		mixpanel.track("email-campaign-visit", {
				"url": window.location.pathname,
				"email_campaign_received": visit_origin
		});
</script>


<!-- Crazy Egg -->
<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0042/1249.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>

<!-- Perfect Audience -->
<script type="text/javascript">
(function() {
  window._pa = window._pa || {};
  // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
  // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
  // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
  var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
  pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/5641f73b04b7cacb9d000124.js";
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
})();
</script>

	</body>
</html>
