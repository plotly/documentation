<!DOCTYPE html>
<html>
	    <head>

        <meta charset="utf-8" />

        <!-- Media query magic - http://stackoverflow.com/questions/19945658/my-iphone-thinks-its-980px-wide -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

    	<!-- Fonts -->
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//fonts/font-awesome/css/font-awesome.min.css" />
        <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/plotly_icons.css" />
        <link href="//fonts.googleapis.com/css?family=Open+Sans:600,400,300,200|Inconsolata|Ubuntu+Mono:400,700" rel="stylesheet" type="text/css" />
	    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <script src="//cdn.plot.ly/plotly-latest.min.js"></script>

    	<!-- Stylesheets -->
        <link rel="stylesheet" href="https://plot.ly/gh-pages/documentation/static//css/js-splash-highlight.css"/>
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/normalize.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/base.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/layout_block.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/modules.css">
    	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/state.css">
        <link rel="stylesheet" href="https://plot.ly/gh-pages/documentation/static//css/js-splash.css"/>
        
        
        <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/api_docs.css">
        
        

    	<!-- Icon -->
    	<link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" type="image/x-icon" />

    	<!-- META TAGS -->
    	<!-- SEO Tags - title, meta_description -->
    <title>Pytables</title>
    <meta name="description" content="An introduction to PyTables and HDF5 for data analysis in Python.">

<!-- Bing tags -->
    <meta name="msvalidate.01" content="D319859A832F9F1D15A7646E2A42150A" />
<!-- Facebook tags -->
    <meta property="og:title" content="PyTables and HDF5 Tutorial"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://plot.ly/gh-pages/documentation/static//images/static-image">
    <meta property="og:description" content="An introduction to PyTables and HDF5 for data analysis in Python."/>
    <meta property="og:url" />
    <meta property="fb:admins" content="1123751525"/>
    <meta property="fb:admins" content="22418"/>

<!-- twitter tags -->
    <meta name="twitter:card" content="photo" />
    <meta name="twitter:title" content="PyTables and HDF5 Tutorial"/>
    <meta name="twitter:url" content="http://help.plot.ly/python/pytables"/>
    <meta name="twitter:description" content="An introduction to PyTables and HDF5 for data analysis in Python."/>
    <meta name="twitter:image" content="https://plot.ly/gh-pages/documentation/static//images/static-image">
    <meta name="twitter:site" content="@plotlygraphs"/>

<!-- Favicon -->
    <link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" />



    	<!-- code highlighting -->
    	<!--<link rel="stylesheet" href="https://plot.ly/gh-pages/documentation/static//javascripts/codehighlight/styles/tomorrow.css">-->
        
	<!-- start Mixpanel --><script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
	for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
	mixpanel.init("ad6df61d0b9400400b240631576c24d4");</script><!-- end Mixpanel -->

	</head>

	<head>
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/state.css">
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/ipython-notebook-base.css">
	<link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/ipython-notebook-custom.css">
	</head>

	<body>
	<div id="header" style="
  background-image: url('https://images.plot.ly/excel/plotlyjs/plotlyjs-banner-background.png');
  background-repeat: no-repeat;
  background-size: cover;
  max-width: 100%;
  background-position: center top;
  width: 100%;
  height: 350px;
  position: relative;
  ">

	<div class="headerbar">

  <div class="headerbar-leftside">
      <a href="https://plot.ly/feed/" class="logo" target="_blank">
          <i class="ploticon-plotlylogo"></i>
          <em>plotly</em>
      </a>
  </div>

  <div class="headerbar-rightside hidesmall">


      <a href="/settings" id="toolsignin" class="headerbar-nav-item --product-header" target="_self">Sign In</a>

      <a class="button --enterprise-quaternary" href="/settings" id="signup" target="_self">
        SIGN UP
      </a>
      
      
        <a class="button" href="/2/~bar-chart-excel/?plot_type=Bar%20chart">
          &plus; NEW PROJECT
        </a>
        <a class="button" href="https://plot.ly/products/cloud/">
          UPGRADE
        </a>
      
      
      <a href="https://plotly.typeform.com/to/seG7Vb" class="typeform-share button --enterprise-quaternary" data-mode="1" target="_blank" onclick="window.mixpanel.track('Typeform demo request');">REQUEST DEMO</a>
      <script>(function(){var qs,js,q,s,d=document,gi=d.getElementById,ce=d.createElement,gt=d.getElementsByTagName,id='typef_orm',b='https://s3-eu-west-1.amazonaws.com/share.typeform.com/';if(!gi.call(d,id)){js=ce.call(d,'script');js.id=id;js.src=b+'share.js';q=gt.call(d,'script')[0];q.parentNode.insertBefore(js,q)}})()
      </script>

  </div>

  <div class="headerbar-nav hidesmall">

      <a href="https://plot.ly/feed/" target="_blank">
      <span class="headerbar-nav-item ">Feed</span>
      </a>

      <a href="https://plot.ly/products/cloud/" target="_blank">
      <span class="headerbar-nav-item ">Pricing</span></span>
      </a>

      <a href="http://dashboards.ly/" target="_blank">
      <span class="headerbar-nav-item ">Dashboards</span></span>
      </a>

      <a href="https://plot.ly/api/" onmouseover="dropDownMenu('api-menu')" onmouseout="hideDropDownMenu('api-menu')" target="_self">
      <span class="headerbar-nav-item ">API</span><span class="caret"></span>
      </a>

          <nav id="api-menu" role="menu" class="dropdown-menu" onmouseover="dropDownMenu('api-menu')" onmouseout="hideDropDownMenu('api-menu')" style="display:none; margin-left: 225px;">
              <a href="/python" class="dropdown-menu-item" target="_blank">PYTHON</a>
              <a href="/r" class="dropdown-menu-item" target="_blank">R</a>
              <a href="/matlab" class="dropdown-menu-item" target="_blank">MATLAB</a>
              <a href="/javascript-graphing-library" class="dropdown-menu-item" target="_blank">JAVASCRIPT</a>
              <a href="/api" class="dropdown-menu-item" target="_blank">MORE</a>
          </nav>

  </div>

  <div class="hamburger">
    <a href='#popmenufull' onclick='return clickfullmenu();'>
      <div id="harburger-menu"></div>
    </a>

  </div>

</div>

<!-- POP UP MENU -->
  <div id="popmenufull" style="display:none;">
      <div class="popupheader">
          <div class="headerbar-leftside">
            <a href="/feed/" class="logo">
              <i class="ploticon-plotlylogo"></i>
              <em>plotly</em>
            </a>
          </div>
          <a href='#popmenufull' onclick='return clickfullmenu();'>
          <div class="close"><img alt="close" src="http://i.imgur.com/esVZHwn.png"></div> </a>
      </div>

      <div class="popupmenu">
        <ul>
          <li><a href="https://plot.ly/feed/">Explore</a></li>
          <li><a href="https://plot.ly/products/cloud/">Pricing</a></li>

          <div onmouseover="dropDownMenu('sub-industries')" onmouseout="hideDropDownMenu('sub-industries')">
            <li><a href="https://plot.ly/products/industries/">Industries</a></li>
            <div class="sub-popmenu" id="sub-industries" style="display:none;">
                <ul class="no-margin">
                  <li class="no-margin"><a href="https://plot.ly/products/industries/finance/">FINANCE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/insurance/">INSURANCE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/aerospace/">AEROSPACE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/energy/">ENERGY</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/research-and-development/">RESEARCH &amp; DEVELOPMENT</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/automotive/">AUTOMOTIVE</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/government-and-public/">GOVERNMENT</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/pharma/">PHARMA &amp; COMPUTATIONAL BIOLOGY</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/journalism/">JOURNALISM</a></li>
                  <li class="no-margin"><a href="https://plot.ly/products/industries/business-intelligence/">BUSINESS INTELLIGENCE</a></li>
                </ul>
            </div>
          </div>
          <div onmouseover="dropDownMenu('sub-api')" onmouseout="hideDropDownMenu('sub-api')">
            <li><a href="https://plot.ly/api/">API</a></li>
            <div class="sub-popmenu" id="sub-api" style="display:none;">
              <ul class="no-margin">
                <li class="no-margin"><a href="/python">PYTHON</a></li>
                <li class="no-margin"><a href="/r">R</a></li>
                <li class="no-margin"><a href="/matlab">MATLAB</a></li>
                <li class="no-margin"><a href="/javascript">JAVASCRIPT</a></li>
                <li class="no-margin"><a href="/api">MORE</a></li>
              </ul>
            </div>
          </div>
        </ul>
      </div>

  </div>

  <!-- POPUP MENU FULL PAGE -->
  <script>
  function clickfullmenu(){
    var thediv=document.getElementById('popmenufull');
    if(thediv.style.display == "none"){
      thediv.style.display = "";
    }else{
      thediv.style.display = "none";
    }
    return false;
  };
  </script>

  <!-- Drop Down Menu -->
  <script>
  function dropDownMenu(divID){
    var chosenDiv = document.getElementById(divID);
    console.log(chosenDiv);
    if(chosenDiv.style.display == "none"){
      chosenDiv.style.display = "block";
    }
  };
  function hideDropDownMenu(divID){
    var chosenDiv = document.getElementById(divID);
    console.log(chosenDiv);
    if(chosenDiv.style.display == "block"){
      chosenDiv.style.display = "none";
    }
  }
  </script>

  <script>
  console.log('got this');
    var hamburgerDiv = document.getElementById('harburger-menu');
    var currentUrl = window.location.href;
    var newImg = document.createElement('img');
    if (currentUrl === 'https://plot.ly/javascript/' ) {
        newImg.setAttribute('src', 'https://plot.ly/gh-pages/documentation/static//images/white-hamburger-bg-transparent.png');
        newImg.setAttribute('alt', 'Menu');
        newImg.setAttribute('id', 'hamburgerlink');
        newImg.setAttribute('onmouseover', 'this.src="https://plot.ly/gh-pages/documentation/static//images/blue-hamburger-bg-transparent.png"');
        newImg.setAttribute('onmouseout', 'this.src="https://plot.ly/gh-pages/documentation/static//images/white-hamburger-bg-transparent.png"');
        hamburgerDiv.appendChild(newImg);
    } else {
        newImg.setAttribute('src', 'http://i.imgur.com/o7Mxj6T.png');
        newImg.setAttribute('alt', 'Menu');
        newImg.setAttribute('id', 'hamburgerlink');
        newImg.setAttribute('onmouseover', 'this.src="http://i.imgur.com/gj2TtuI.png"');
        newImg.setAttribute('onmouseout', 'this.src="http://i.imgur.com/o7Mxj6T.png"');
        hamburgerDiv.appendChild(newImg);
    }

  </script>

  <div style="
    background-image: linear-gradient(0deg, rgba(100,91,158, 0.89)  0%, rgba(58,124,187, 0.89) 100%);
    width: 100%;
    height: 100%;
  "></div>
  
    <!-- Lang Banner -->
    <div class="js-splash--banner-container">
    <div class="js-splash--banner-title" style="font-size: 5rem; margin-top: 0; margin-bottom: 2rem; font-weight: 300; font-family:'Open sans',verdana,arial,sans-serif;">
    
    </div>
    <div class="js-splash--banner-subtitle" style="font-size: 2.2rem; letter-spacing: 0.3px; font-weight: 100;  margin-top: 0; margin-bottom: 2rem; font-weight: 300; font-family:'Open sans',verdana,arial,sans-serif;">
    
        <div style="padding-top: 30px;">
          <h6 style="font-size:30px; color: rgb(255,255,255);">Plotly for Python is now entirely open source, free, and self-hosted</h6>
          <h5 style="font-size:30px; color: rgb(255,255,255);" style="text-align: center;">
            Learn more about <a style="color: #ABB9D2;" href="https://plot.ly/javascript/open-source-announcement">why we've open sourced</a>
          </h5>
        </div>
    
    </div>
    
    
       <iframe src="https://ghbtns.com/github-btn.html?user=plotly&repo=plotly.py&type=star&count=true&size=large" frameborder="0" scrolling="0" width="160px" height="30px"></iframe>
    
</div>


</div>

    <!-- sitemap -->
    <div class="navigation-bar">

    <p class="align-left padding_left_small"><a href="http://help.plot.ly/"><i class="fa fa-life-ring"></i> Help</a><span>/</span><a href="/api/">API Libraries</a><span>/</span><a href="/python"  >Python</a><span>/</span><a href="#">PyTables and HDF5 Tutorial</a></p>

    <div class="float-right padding_right_small" style="margin-top:10px;">
        
            <a id="forklink" href="https://github.com/plotly/plotly.py"><i class="fa fa-github-alt"></i> Fork on GitHub</a>
        
    </div>

</div>


		<div class="allcontent">
			
			<div class="sectionseparator_white">
				<div class="container">



					
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="HDF5-and-Plotly">HDF5 and Plotly<a class="anchor-link" href="#HDF5-and-Plotly">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook will give an overview of using the excellent <a href="https://www.hdfgroup.org/HDF5/">HDF5 Data Format</a> for high performance computing and <a href="https://plot.ly/">Plotly</a> to graph data stored in this files.
 Plotly is a web-based graphing platform that lets you make and share interactive graphs and dashboards. You can use it for free online--sign up for an account <a href="https:www.plot.ly">here</a>--and on-premise with <a href="https://plot.ly/product/enterprise/">Plotly Enterprise</a>.</p>
<p>For those unfamilar with the HDF5 file format:</p>
<p>HDF5 is a data model, library, and file format for storing and managing data. It supports an unlimited variety of datatypes, and is designed for flexible and efficient I/O and for high volume and complex data. HDF5 is portable and is extensible, allowing applications to evolve in their use of HDF5. The HDF5 Technology suite includes tools and applications for managing, manipulating, viewing, and analyzing data in the HDF5 format.</p>
<p>-- <a href="https://www.hdfgroup.org/HDF5/">The HDF5 Group</a></p>
<p>The HDF group has some great reasons to use their files - namely that it works great with all kind of data. You can <a href="https://www.hdfgroup.org/why_hdf/">read more here.</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="kn">as</span> <span class="nn">py</span> <span class="c"># interactive graphing</span>
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="n">Bar</span><span class="p">,</span> <span class="n">Scatter</span><span class="p">,</span> <span class="n">Marker</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">Data</span><span class="p">,</span> <span class="n">Figure</span><span class="p">,</span> <span class="n">Heatmap</span><span class="p">,</span> <span class="n">XAxis</span><span class="p">,</span> <span class="n">YAxis</span>
<span class="kn">import</span> <span class="nn">plotly.tools</span> <span class="kn">as</span> <span class="nn">tls</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset that we'll be using is data from <a href="https://nycopendata.socrata.com/data">NYC's open data portal</a>. We'll be exploring a 100mb dataset covering traffic accidents in NYC. While we are capable of fitting this data into memory, the HDF5 file format has some unique affordances that allow us to query and save data in convenient ways.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now the first thing we'll want to do is open up an access point to this HDF5 file, doing so is simple because pandas provides ready access to doing so.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">&#39;io.hdf.default_format&#39;</span><span class="p">,</span><span class="s">&#39;table&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s">&#39;nypd_motors.h5&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we've opened up our store, let's start storing some data</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># df = pd.read_csv(&#39;NYPD_motor_collisions.csv&#39;, parse_dates=[&#39;DATE&#39;])</span>
<span class="c"># df.columns = [col.lower().replace(&quot; &quot;, &quot;_&quot;) for col in df.columns]</span>
<span class="c"># store.append(&quot;nypd&quot;, df,format=&#39;table&#39;,data_columns=True)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">store</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[5]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;class &apos;pandas.io.pytables.HDFStore&apos;&gt;
File path: nypd_motors.h5
/nypd            frame_table  (typ-&gt;appendable,nrows-&gt;596990,ncols-&gt;29,indexers-&gt;[index],dc-&gt;[date,time,borough,zip_code,latitude,longitude,location,on_street_name,cross_street_name,off_street_name,number_of_persons_injured,number_of_persons_killed,number_of_pedestrians_injured,number_of_pedestrians_killed,number_of_cyclist_injured,number_of_cyclist_killed,number_of_motorist_injured,number_of_motorist_killed,contributing_factor_vehicle_1,contributing_factor_vehicle_2,contributing_factor_vehicle_3,contributing_factor_vehicle_4,contributing_factor_vehicle_5,unique_key,vehicle_type_code_1,vehicle_type_code_2,vehicle_type_code_3,vehicle_type_code_4,vehicle_type_code_5])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="c"># store.close()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One thing that's nice about the HDF5 file is that it's kind of like a key value store. It's simple to use, and allows you to store things just like you might in a file system type hierarchy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What's awesome about the HDF5 format is that it's almost like a miniature file system. It supports hierarchical data and is accessed like a python dictionary.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s">&quot;df&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;nypd&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[8]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>time</th>
      <th>borough</th>
      <th>zip_code</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>location</th>
      <th>on_street_name</th>
      <th>cross_street_name</th>
      <th>off_street_name</th>
      <th>...</th>
      <th>contributing_factor_vehicle_2</th>
      <th>contributing_factor_vehicle_3</th>
      <th>contributing_factor_vehicle_4</th>
      <th>contributing_factor_vehicle_5</th>
      <th>unique_key</th>
      <th>vehicle_type_code_1</th>
      <th>vehicle_type_code_2</th>
      <th>vehicle_type_code_3</th>
      <th>vehicle_type_code_4</th>
      <th>vehicle_type_code_5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-06-02</td>
      <td>13:48</td>
      <td>MANHATTAN</td>
      <td>10038</td>
      <td>40.711780</td>
      <td>-73.999701</td>
      <td>(40.7117796, -73.9997006)</td>
      <td>ST JAMES PLACE</td>
      <td>MADISON STREET</td>
      <td>NaN</td>
      <td>...</td>
      <td>Unspecified</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3232026</td>
      <td>VAN</td>
      <td>VAN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-06-02</td>
      <td>13:40</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>Turning Improperly</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3232021</td>
      <td>PASSENGER VEHICLE</td>
      <td>SPORT UTILITY / STATION WAGON</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-06-02</td>
      <td>13:40</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1200 WATERS PLACE - PARKING LOT</td>
      <td>...</td>
      <td>Unspecified</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3232261</td>
      <td>PASSENGER VEHICLE</td>
      <td>PASSENGER VEHICLE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015-06-02</td>
      <td>13:40</td>
      <td>MANHATTAN</td>
      <td>10004</td>
      <td>40.706701</td>
      <td>-74.016047</td>
      <td>(40.7067007, -74.0160467)</td>
      <td>WEST STREET</td>
      <td>MORRIS STREET</td>
      <td>NaN</td>
      <td>...</td>
      <td>Unspecified</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3232015</td>
      <td>UNKNOWN</td>
      <td>PASSENGER VEHICLE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015-06-02</td>
      <td>13:38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>WOOLLEY AVENUE</td>
      <td>GURDON STREET</td>
      <td>NaN</td>
      <td>...</td>
      <td>Other Vehicular</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3233372</td>
      <td>PASSENGER VEHICLE</td>
      <td>PASSENGER VEHICLE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">boroughs</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;nypd&quot;</span><span class="p">,</span> <span class="s">&quot;columns=[&#39;borough&#39;]&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">boroughs</span><span class="p">[</span><span class="s">&#39;COUNT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">borough_groups</span> <span class="o">=</span> <span class="n">boroughs</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;borough&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">borough_groups</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">index</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Index([u&apos;BRONX&apos;, u&apos;BROOKLYN&apos;, u&apos;MANHATTAN&apos;, u&apos;QUEENS&apos;, u&apos;STATEN ISLAND&apos;], dtype=&apos;object&apos;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">([</span><span class="n">Bar</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">borough_groups</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="s">&#39;COUNT&#39;</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">borough_groups</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">)])</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Borough&quot;</span><span class="p">),</span> <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Accident Count&#39;</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[13]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/474.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dates_borough</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;nypd&quot;</span><span class="p">,</span> <span class="s">&quot;columns=[&#39;date&#39;, &#39;borough&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s">&#39;date&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">dates_borough</span><span class="p">[</span><span class="s">&#39;COUNT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">date_borough_sum</span> <span class="o">=</span> <span class="n">dates_borough</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">&#39;borough&#39;</span><span class="p">,</span> <span class="s">&quot;date&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">date_borough_sum</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[16]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>COUNT</th>
    </tr>
    <tr>
      <th>borough</th>
      <th>date</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">BRONX</th>
      <th>2012-07-01</th>
      <td>39</td>
    </tr>
    <tr>
      <th>2012-07-02</th>
      <td>71</td>
    </tr>
    <tr>
      <th>2012-07-03</th>
      <td>73</td>
    </tr>
    <tr>
      <th>2012-07-04</th>
      <td>51</td>
    </tr>
    <tr>
      <th>2012-07-05</th>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">date_borough_sum</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;borough&#39;</span><span class="p">):</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">COUNT</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">g</span><span class="p">))</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">xaxis</span><span class="o">=</span><span class="n">XAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Date&quot;</span><span class="p">),</span> <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Accident Count&quot;</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">Data</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">),</span> <span class="n">filename</span><span class="o">=</span><span class="s">&#39;nypd_crashes/over_time&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[18]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/274.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Luckily for us, while this graph is a bit of a mess, we can still zoom in on specific times and ranges. This makes plotly perfect for exploring datasets. You can create a high level visual of the data then zoom into a more detailed level.</p>
<p>See below where using the above graph I could zoom in on a particular point and anontate it for future investigation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">tls</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="s">&quot;https://plot.ly/~bill_chambers/274&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[19]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/274.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">car_types</span> <span class="o">=</span> <span class="n">store</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">&quot;nypd&quot;</span><span class="p">,</span> <span class="s">&quot;columns=[&#39;vehicle_type_code_1&#39;, &#39;vehicle_type_code_2&#39;]&quot;</span><span class="p">)</span>
<span class="n">car_types</span><span class="p">[</span><span class="s">&#39;COUNT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">code_1</span> <span class="o">=</span> <span class="n">car_types</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;vehicle_type_code_1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">code_2</span> <span class="o">=</span> <span class="n">car_types</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;vehicle_type_code_2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">([</span>
        <span class="n">Bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">code_1</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">code_1</span><span class="o">.</span><span class="n">COUNT</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;First Vehicle Type&#39;</span><span class="p">),</span>
        <span class="n">Bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">code_2</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">code_2</span><span class="o">.</span><span class="n">COUNT</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Second Vehicle Type&#39;</span><span class="p">)</span>
     <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">barmode</span><span class="o">=</span><span class="s">&#39;group&#39;</span><span class="p">,</span> <span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Vehicle Incidents&quot;</span><span class="p">))))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[23]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/476.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No big surprises here, we can see that passenger vehicles, likely being the most prevalent vehicles, are the ones involved in the most accidents for the first and second vehicles. However this does make for some more interesting questions, does this extrapolate to each vehicle class. That is, do all kinds of vehicles hit all other vehicles in more or less the same frequency?</p>
<p>Let's explore large commercial vehicles.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">large_vehicles</span> <span class="o">=</span> <span class="n">car_types</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="s">&#39;vehicle_type_code_1&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span>
    <span class="s">&#39;LARGE COM VEH(6 OR MORE TIRES)&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">&#39;vehicle_type_code_2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">([</span><span class="n">Bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">large_vehicles</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">large_vehicles</span><span class="o">.</span><span class="n">COUNT</span><span class="p">)])</span>
<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Incident Per Vehicle Type&quot;</span><span class="p">))))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/478.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At first glance it seems alright, but it's worth more exploration - let's Z-Score the data and compare their scores.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">large_vehicles</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[26]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT</th>
    </tr>
    <tr>
      <th>vehicle_type_code_2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AMBULANCE</th>
      <td>9</td>
    </tr>
    <tr>
      <th>BICYCLE</th>
      <td>98</td>
    </tr>
    <tr>
      <th>BUS</th>
      <td>151</td>
    </tr>
    <tr>
      <th>FIRE TRUCK</th>
      <td>6</td>
    </tr>
    <tr>
      <th>LARGE COM VEH(6 OR MORE TIRES)</th>
      <td>878</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">code_2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[27]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT</th>
    </tr>
    <tr>
      <th>vehicle_type_code_2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AMBULANCE</th>
      <td>842</td>
    </tr>
    <tr>
      <th>BICYCLE</th>
      <td>13891</td>
    </tr>
    <tr>
      <th>BUS</th>
      <td>8935</td>
    </tr>
    <tr>
      <th>FIRE TRUCK</th>
      <td>412</td>
    </tr>
    <tr>
      <th>LARGE COM VEH(6 OR MORE TIRES)</th>
      <td>10299</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="k">def</span> <span class="nf">z_score</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s">&#39;zscore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">COUNT</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">COUNT</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">COUNT</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">([</span>
        <span class="n">Bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">z_score</span><span class="p">(</span><span class="n">code_2</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">z_score</span><span class="p">(</span><span class="n">code_2</span><span class="p">)</span><span class="o">.</span><span class="n">zscore</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;All Vehicles&#39;</span><span class="p">),</span>
        <span class="n">Bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">z_score</span><span class="p">(</span><span class="n">large_vehicles</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">z_score</span><span class="p">(</span><span class="n">large_vehicles</span><span class="p">)</span><span class="o">.</span><span class="n">zscore</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Large Vehicles&#39;</span><span class="p">),</span>
        
     <span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">Layout</span><span class="p">(</span><span class="n">yaxis</span><span class="o">=</span><span class="n">YAxis</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&quot;Incident Per Vehicle Type&quot;</span><span class="p">))),</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;nypd_crashes/large vs all vehicles&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[30]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/480.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that things are relatively similar, except that large vehicles seem to hit large vehicles much more than most others. This could warrant further investigation.</p>
<p>While grouped bar charts can be useful for these kinds of comparisons, it can be great to visualize this data with heatmaps as well. We can create one of these by creation a contingency table or cross tabulation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">cont_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">car_types</span><span class="p">[</span><span class="s">&#39;vehicle_type_code_1&#39;</span><span class="p">],</span> <span class="n">car_types</span><span class="p">[</span><span class="s">&#39;vehicle_type_code_2&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because of the different magnitudes of data, I decided to log scale it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">Data</span><span class="p">([</span>
            <span class="n">Heatmap</span><span class="p">(</span><span class="n">z</span> <span class="o">=</span> <span class="n">cont_table</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">cont_table</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">cont_table</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">colorscale</span><span class="o">=</span><span class="s">&#39;Jet&#39;</span><span class="p">)</span>
        <span class="p">]),</span><span class="n">filename</span><span class="o">=</span><span class="s">&#39;nypd_crashes/vehicle to vehicle heatmap&#39;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt output_prompt">Out[32]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<iframe id="igraph" scrolling="no" style="border:none;"seamless="seamless" src="https://plot.ly/~bill_chambers/333.embed" height="525" width="100%"></iframe>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With this we are able to see more interesting nuances in the data. For instance taxis seems to have lots of accidents with other taxis, while vans and station wagons also seem to have many accidents.</p>
<p>There's clearly a lot to explore in this dataset.</p>

</div>
</div>
</div>

				</div>
			</div>
		</div>
    <footer>
<div class="plotly-footer">
	<div style="
    background-image: url('https://images.plot.ly/background-images/grey-chart-background.png');
    height: 200px;
    font-family: 'Open sans',verdana,arial,sans-serif;
    position: relative;">

<h2 style="
    text-align: center;
    background-color: rgba(255,255,255,0.9);
    margin: 0px;
    padding-top: 20px;
    font-family: 'Open sans',verdana,arial,sans-serif;">upgrade to pro</h2>

<h5 style="
    text-align: center;
    background-color: rgba(255,255,255,0.9);
    margin: 0;
    padding: 20px 0px;
    color: black;
    font-family: 'Open sans',verdana,arial,sans-serif;">unlimited private files & email support</h5>

<div style="
    text-align: center;
    height: 50%;
    font-family: 'Open sans',verdana,arial,sans-serif;
    background-color: rgba(255,255,255,0.9);">

<a class="button trial-offline-cta" href="https://plot.ly/products/cloud/">$20 per month</a>

</div>
</div>

	<div class="row footerarea footer-top" style="z-index: 100; position: relative;">
		<div class="one column footcolumn space"> </div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">API</h6>
			<ul>
				<li><a  href="https://plot.ly/api/" target="_self">Documentation</a></li>
				<li><a  href="https://plot.ly/api/" target="_self">API Libraries</a></li>
				<li><a  href="https://plot.ly/rest/" target="_self">REST APIs</a></li>
				<li><a  href="https://plot.ly/javascript/" target="_self">Plotly.js</a></li>
				<li><a  href="https://plot.ly/workshop/" target="_self">Hardware</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">About Us</h6>
			<ul>
				<li><a href="https://plot.ly/company/team/" target="_self">Team</a></li>
				<li><a href="https://plot.ly/company/jobs/" target="_self">Careers</a></li>
				<li><a href="http://blog.plot.ly" target="_blank">Plotly Blog</a></li>
				<li><a href="http://moderndata.plot.ly" target="_blank">Modern Data</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">Help</h6>
			<ul>
				<li><a href="https://plot.ly/learn/" target="_self">Knowledge Base</a></li>
				<li><a href="https://plot.ly/benchmarks/" target="_self">Benchmarks</a></li>
				<li><a href="https://plot.ly/workshop/" target="_self">Workshop</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
			<h6 class="footer-heading">Solutions</h6>
			<ul>
				<li><a href="https://plot.ly/product/plans/" target="_self">Plans &amp; Pricing</a></li>
				<li><a href="https://plot.ly/product/enterprise/" target="_self">Enterprise</a></li>
				<li><a href="https://plot.ly/online-graphing-and-statistics-for-educators/" target="_self">Education</a></li>
				<li><a href="https://plot.ly/product/plotlyjs/" target="_self">Plotly.js</a></li>
			</ul>
		</div>
		<div class="two columns footcolumn respfooter">
     		<h6 class="footer-heading">Connect</h6>
			<ul class="plotly-social-media-small">
				<li><a href="//twitter.com/plotlygraphs" target="_blank"><i class="icon-twitter social_icon"></i></a></li>
				<li><a href="//www.facebook.com/Plotly" target="_blank"><i class="icon-facebook social_icon"></i></a></li>
				<li><a href="//github.com/plotly" target="_blank"><i class="icon-github social_icon"></i></a></li>
				<li><a href="//linkedin.com/company/plotly" target="_blank"><i class="icon-linkedin social_icon"></i></a></li>
				<li><a href="//plus.google.com/+PlotLy" target="_blank"><i class="icon-google-plus  social_icon"></i></a></li>
			</ul>
		</div>
		<div class="one column footcolumn"></div>
	</div>

	<div class="row footerarea footer-bottom" style="z-index: 100; position: relative;">
		<div class="one column footcolumn space"> </div>
		<div class="four columns footcolumn"><p>Copyright &copy; 2015 Plotly. All rights reserved.</p></div>
		<div class="two columns footcolumn"><a href="https://plot.ly/terms-of-service/" target="_blank" ><p>Terms of Service</p></a></div>
		<div class="two columns footcolumn"><a href="https://plot.ly/privacy/" target="_blank"><p>Privacy Policy</p></a></div>


	</div>
</div>
</footer>


<!-- Mathjax -->
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}});
</script>
<script type='text/javascript' src='//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML%2CSafe.js&#038;ver=4.1'></script>


<!-- Image Hover Script -->
<script src="https://plot.ly/gh-pages/documentation/static//javascripts/imghover.js"></script>

<!-- code highlighting -->
<script src="https://plot.ly/gh-pages/documentation/static//javascripts/codehighlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-39373211-1', 'auto');
  ga('send', 'pageview');
</script>

<!-- start Mixpanel --><script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
mixpanel.init("ad6df61d0b9400400b240631576c24d4");</script><!-- end Mixpanel -->

<script type="text/javascript">
    mixpanel.track("Page visit", {
        "url_group": "API docs - GitHub pages",
        "url": window.location.pathname
    });
</script>

<script type="text/javascript">
function getQueryParam(param) {
    param = param.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + param + "=([^&#]*)",
        regex = new RegExp( regexS ),
        results = regex.exec(document.URL);
    if (results === null || (results && typeof(results[1]) !== 'string' && results[1].length)) {
        return '';
    } else {
        return decodeURIComponent(results[1]).replace(/\+/g, ' ');
    }
};
</script>

<script type="text/javascript">
    var visit_origin = getQueryParam("campaign_id");

    mixpanel.register({
        "email_campaign_received": visit_origin
    });

		mixpanel.track("email-campaign-visit", {
				"url": window.location.pathname,
				"email_campaign_received": visit_origin
		});
</script>


<!-- Crazy Egg -->
<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0042/1249.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>

<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-563d60eba90f0f45" async="async"></script>

<!-- Perfect Audience -->
<script type="text/javascript">
(function() {
  window._pa = window._pa || {};
  // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
  // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
  // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
  var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
  pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.marinsm.com/serve/5641f73b04b7cacb9d000124.js";
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
})();
</script>

	</body>
</html>
