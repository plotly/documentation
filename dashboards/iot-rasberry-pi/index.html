<!DOCTYPE html>
<html>
<head>

<!-- SEO Tags - title, meta_description -->
    <title>IoT Raspberry Pi Dashboard</title>
    <meta name="description" content="Internet-of-things dashboard of sensor readings streamed from a Rasberry Pi embedded system.">

<!-- Bing tags -->
    <meta name="msvalidate.01" content="D319859A832F9F1D15A7646E2A42150A" />
<!-- Facebook tags -->
    <meta property="og:title" content="IoT Raspberry Pi Dashboard"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="http://help.plot.ly/images/twitter-default.png">
    <meta property="og:description" content="Internet-of-things dashboard of sensor readings streamed from a Rasberry Pi embedded system."/>
    <meta property="og:url" />
    <meta property="fb:admins" content="1123751525"/>
    <meta property="fb:admins" content="22418"/>

<!-- twitter tags -->
    <meta name="twitter:card" content="photo" />
    <meta name="twitter:title" content="IoT Raspberry Pi Dashboard"/>
    <meta name="twitter:url" content="http://help.plot.lydashboards/iot-rasberry-pi/"/>
    <meta name="twitter:description" content="Internet-of-things dashboard of sensor readings streamed from a Rasberry Pi embedded system."/>
    <meta name="twitter:image" content="http://help.plot.ly/images/twitter-default.png">
    <meta name="twitter:site" content="@plotlygraphs"/>

<!-- Favicon -->
    <link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" />



  <link rel="shortcut icon" href="https://plot.ly/gh-pages/documentation/static//images/plotly-ico.png" />
  <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//fonts/font-awesome/css/font-awesome.min.css" />
  <link href="//fonts.googleapis.com/css?family=Open+Sans:600,400,300,200|Inconsolata|Ubuntu+Mono:400,700" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/keen-dashboards.css" />
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <!-- For slider -->
  <link rel="stylesheet" type="text/css" href="https://plot.ly/gh-pages/documentation/static//css/iThing.css" />
</head>
<body class="application">

<div class="navbar navbar-inverse navbar-fixed-top navbar-industries" role="navigation" 
  style="background-color:#CC0000; border-color:#CC0000; color:white;">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/dashboards">
        <span class="glyphicon glyphicon-chevron-left"></span>
      </a>
      <a class="navbar-brand" href="/dashboards">
        <h1 class="dash-title">Internet of things Dashboard</h1>
      </a>      
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-left">
        <li><a href="https://plot.ly/organize/home">Sign up</a></li> 
        <li><a href="https://plot.ly/products/cloud/">Pricing</a></li> 
        <li><a href="http://dashboards.ly/"><span class="create-dashboard-cta">Create a Dashboard</span></a></li>
      </ul>
    </div>
  </div>
</div>


<div class="container-fluid">

    <h2>Dashboard charts of Rasberry Pi Streaming Temperature Data</h2>

    <div class="row">
      <div class="col-sm-3">
        <div class="chart-wrapper">
          <div class="chart-title">
            Rasberry Pi and Ethernet Shield
          </div>
          <div class="chart-stage">
              <img src="http://cdn.instructables.com/FT8/296W/HS18FTON/FT8296WHS18FTON.MEDIUM.jpg" style="margin-left:-100px;">
          </div>
        </div>
      </div>
      <div class="col-sm-9">
        <div class="chart-wrapper">
          <div class="chart-title">
            Temperature (C) vs Time <a href="https://plot.ly/raspberry-pi/tmp36-temperature-tutorial/">Read the Tutorial</a>
          </div>
          <div class="chart-stage">
              <iframe width="100%" height="410px;" frameborder="0" scrolling="no" id="temperature-line-plot" src="https://plot.ly/~jackp/12028.embed?autoscale=true&link=false"></iframe>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-3">
        <div class="chart-wrapper">
          <div class="chart-title">
            Temperature Histogram
          </div>
          <div class="chart-stage">
              <iframe width="100%" height="410px;" frameborder="0" scrolling="no" id="temperature-hist-plot" src="https://plot.ly/~jackp/12028.embed?autoscale=true&link=false"></iframe>
          </div>
        </div>
      </div>
      <div class="col-sm-9">
        <div class="chart-wrapper">
          <div class="chart-title">
            Temperature 2d Histogram
          </div>
          <div class="chart-stage">
              <iframe width="100%" height="410px;" frameborder="0" scrolling="no" id="temperature-density-plot" src="https://plot.ly/~jackp/12028.embed?autoscale=true&link=false"></iframe>
          </div>
        </div>
      </div>
    </div>

    <h2>Dashboard charts of Rasberry Pi Streaming Dissolved Oxygen Sensor Data</h2>    

    <div class="row">
      <div class="col-sm-3">
        <div class="chart-wrapper">
          <div class="chart-title">
            Raspberry Pi and DO Sensor
          </div>
          <div class="chart-stage">
              <img src="http://cdn.instructables.com/FWM/ZIJN/HUMTMWWM/FWMZIJNHUMTMWWM.MEDIUM.jpg" style="margin-left:-100px;">
          </div>
        </div>
      </div>
      <div class="col-sm-9">
        <div class="chart-wrapper">
          <div class="chart-title">
            Dissolved Oxygen (mg/mL) vs Time <a href="http://www.instructables.com/id/Plotly-Atlas-Scientific-Graph-Real-Time-Dissolved-/">Get the Tutorial</a>
          </div>
          <div class="chart-stage">
              <iframe width="100%" height="460px;" frameborder="0" scrolling="no" id="dissolved-oxygen-plot" src="https://plot.ly/~jackp/12028.embed?autoscale=true&link=false"></iframe>
          </div>
        </div>
      </div>
    </div>

  </div>

    <hr>

    <p class="small text-muted">
        <a href="http://dashboards.ly/">Create your own dashboards</a>.
    </p>

  </div>

  <script type="text/javascript" src="https://plot.ly/gh-pages/documentation/static//javascripts/slider/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="https://plot.ly/gh-pages/documentation/static//javascripts/bootstrap/dist/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://plot.ly/gh-pages/documentation/static//javascripts/dashboard-industries.js"></script>


<script>

var INTERVAL = 600;
var X, Y, dX, dY, addTemperatureData, lastUpdate;
var COLORSCALE = [[0.0, 'rgb(34.0, 34.0, 34.0)'],
 [0.2, 'rgb(59.799999999999997, 27.199999999999999, 27.199999999999999)'],
 [0.4, 'rgb(85.600000000000009, 20.399999999999999, 20.399999999999999)'],
 [0.6, 'rgb(111.40000000000001, 13.6, 13.6)'],
 [0.8, 'rgb(137.20000000000002, 6.799999999999998, 6.799999999999998)'],
 [1.0, 'rgb(163.0, 0.0, 0.0)']];

var plotLine = document.getElementById('temperature-line-plot').contentWindow;
var plotHist = document.getElementById('temperature-hist-plot').contentWindow;
var plotDensity = document.getElementById('temperature-density-plot').contentWindow;
var disOxyPlot = document.getElementById('dissolved-oxygen-plot').contentWindow;

var disOxy_X = [];
var disOxy_Y = [];

function addData() {
  // get current x, y data
  plotLine.postMessage({
      task: 'getAttributes',
      attributes: [ 'data[0].x', 'data[0].y' ],
    },
    'https://plot.ly/');  
}

window.addEventListener('message', function(e) {
    var message = e.data;
  
    if (message.pong) {
      console.log('Initial pong, \
         frame is ready to receive');
      clearInterval(pinger);
      clearInterval();
      clearTimeout();
      addTemperatureData = setInterval(addData, INTERVAL);
    }    
    else if( 'data[0].x' in message.response ){

      X = message.response['data[0].x'];
      Y = message.response['data[0].y'];

      dt = new Date();

      if( dt-lastUpdate < INTERVAL ){
        return;
      }

      lastUpdate = dt;

      dt = dt.toISOString()
        .slice(0, 23)
        .replace('T', ' ');
      
      if( X === undefined ){
        var seconds = 5;
        var dt0 = new Date(
          (new Date).getTime() - seconds*INTERVAL );
        dt0 = dt0.toISOString().slice(0, 23).replace('T', ' ');
        X = [ dt0 ];
        Y = [ normal()*10+30 ];
      }
      else{
        // append new data  
        dY = normal()*10+30;
        X.push( dt );
        Y.push( dY );
      }
      
      if( X.length > 200 ){
        X.shift(); Y.shift();
      }
      
      console.log(dt, X.length);

      plotLine.postMessage({
        task: 'restyle',
        update: { 
          x: [X], y: [Y],
          marker: { color: '#A30000' },
        }
      }, 'https://plot.ly');

      plotHist.postMessage({
        task: 'restyle',
        update: { 
          x: [Y], 
          type: 'histogram',
          marker: { color: '#A30000' },
        }
      }, 'https://plot.ly');

      plotDensity.postMessage({
        task: 'restyle',
        update: { 
          x: [X], y: [Y],
          type: 'histogram2d',
          nbinsx:50,
          nbinsy:50,
          reversescale:false,
          colorscale:[COLORSCALE],
        }
      }, 'https://plot.ly');      

      // Dissolved Oxy plot

      disOxy_X.push( dt );
      disOxy_Y.push( (normal()*10+30)*(Math.sin( (new Date).getTime() )+30) );

      if( disOxy_X.length > 300 ){
        disOxy_X.shift(); disOxy_Y.shift();
      }

      disOxyPlot.postMessage({
        task: 'restyle',
        update: { 
          x: [ disOxy_X ], 
          y: [ disOxy_Y ], 
          marker: { color: '#A30000' },
          line: { shape: "hvh" },
          fill: 'tonexty' }
      }, 'https://plot.ly'); 
    } 
});

var pinger = setInterval(function() {
  plotLine.postMessage({
    task: 'ping'
  }, 'https://plot.ly')
}, 100);

</script>

</body>
</html>
